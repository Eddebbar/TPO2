
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Spin up Dask Cluster/Client &#8212; Mesoscale Oxygen Dynamics in the Tropical Pacific</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Mesoscale Oxygen Dynamics in the Tropical Pacific</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Tropical Pacific Oxygen Dynamics at the Mesoscale
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Processing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../data_processing/process_data.html">
   Data Processing
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Model Validation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../validation/model_validation.html">
   Model Validation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Budget Analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../o2_section.html">
   Oxygen Distribution
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../o2_budget_analysis_cesm_0.1_core.html">
     Budget Analysis: Steady State
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Lagrangian Analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../lagrangian_analysis/lagrangian_analysis_cesm_0.1_core.html">
   Lagrangian Tracks &amp; Budget
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Summary
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../../summary.html">
   Summary
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/Eddebbar/TPO2/master?urlpath=lab/tree/docs/notebooks/budget_analysis/working/Analysis_O2_Budget_MITgcm.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://jupyterhub.hpc.ucar.edu/dev/hub/user-redirect/git-pull?repo=https://github.com/Eddebbar/TPO2&urlpath=lab/tree/TPO2/docs/notebooks/budget_analysis/working/Analysis_O2_Budget_MITgcm.ipynb&branch=master"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/Eddebbar/TPO2"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/notebooks/budget_analysis/working/Analysis_O2_Budget_MITgcm.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Spin up Dask Cluster/Client
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-monthly-mean-budget-terms-and-take-the-longterm-mean">
   Load Monthly Mean Budget Terms and take the longterm mean
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-longterm-mean-budget">
   Plot Longterm Mean Budget
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-seasonal-cycle">
   Plot Seasonal Cycle
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-interannual-variability-in-budget-terms-and-enso-influence">
   Plot Interannual Variability in Budget Terms and ENSO Influence
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dynamics-of-o2-mixing-and-air-sea-flux">
   Dynamics of O2 mixing and air-sea flux
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-eddy-kinetic-energy-using-residual-from-from-90-days-running-mean">
     Calculate Eddy Kinetic Energy using residual from from 90 days running mean:
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Spin up Dask Cluster/Client</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Spin up Dask Cluster/Client
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-monthly-mean-budget-terms-and-take-the-longterm-mean">
   Load Monthly Mean Budget Terms and take the longterm mean
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-longterm-mean-budget">
   Plot Longterm Mean Budget
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-seasonal-cycle">
   Plot Seasonal Cycle
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plot-interannual-variability-in-budget-terms-and-enso-influence">
   Plot Interannual Variability in Budget Terms and ENSO Influence
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dynamics-of-o2-mixing-and-air-sea-flux">
   Dynamics of O2 mixing and air-sea flux
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-eddy-kinetic-energy-using-residual-from-from-90-days-running-mean">
     Calculate Eddy Kinetic Energy using residual from from 90 days running mean:
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p>This notebook analyzes the O<span class="math notranslate nohighlight">\(_2\)</span> budget from MITgcm+BLING output. Dissolved oxygen in the ocean’s interior is simulated following:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial{O_2}}{\partial{t}}= \underbrace{- \frac{\partial{U.O_2}}{\partial{x}} -\frac{\partial{V.O_2}}{\partial{y}}}_\text{Lateral Advection}
- \overbrace{\frac{\partial{W.O_2}}{\partial{z}}}^\text{Vertical Advection}
+ \underbrace{A_h.\nabla^2{O_2}}_\text{Lateral Mixing}
+\overbrace{\frac{\partial{}}{\partial{z}}k.\frac{\partial{O_2}}{\partial{z}}}^\text{Vertical Mixing}
+ \underbrace{ J(O_2)  }_\text{Sources - Sinks}
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span> <span class="c1"># Silence warnings</span>

<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="kn">import</span> <span class="nn">matplotlib.colors</span> <span class="k">as</span> <span class="nn">colors</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">mticker</span>
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">patches</span>
<span class="kn">import</span> <span class="nn">cmocean</span>
<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">cartopy</span> <span class="kn">import</span> <span class="n">util</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cft</span>
<span class="kn">import</span> <span class="nn">proplot</span>
<span class="c1"># from xmovie import *</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">xgcm</span> <span class="kn">import</span> <span class="n">Grid</span>

<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The autoreload extension is already loaded. To reload it, use:
  %reload_ext autoreload
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<section id="spin-up-dask-cluster-client">
<h1>Spin up Dask Cluster/Client<a class="headerlink" href="#spin-up-dask-cluster-client" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">=</span><span class="n">CLSTR</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">209</span><span class="p">,</span><span class="mi">36</span><span class="p">)</span>
<span class="n">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-226c1c42-95c5-11ec-a4cf-3cecef1acb68</p>
        <table style="width: 100%; text-align: left;">

        <tr>

            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> dask_jobqueue.PBSCluster</td>

        </tr>


            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="https://jupyterhub.hpc.ucar.edu/stable/user/yeddebba/proxy/37973/status" target="_blank">https://jupyterhub.hpc.ucar.edu/stable/user/yeddebba/proxy/37973/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>


        </table>


            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;">PBSCluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">c4dabcb0</p>
        <table style="width: 100%; text-align: left;">
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="https://jupyterhub.hpc.ucar.edu/stable/user/yeddebba/proxy/37973/status" target="_blank">https://jupyterhub.hpc.ucar.edu/stable/user/yeddebba/proxy/37973/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 0
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 0
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 0 B
                </td>
            </tr>

        </table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-3936931b-db29-46ce-94cc-7c052d1622b4</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://10.12.206.46:44660
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 0
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="https://jupyterhub.hpc.ucar.edu/stable/user/yeddebba/proxy/37973/status" target="_blank">https://jupyterhub.hpc.ucar.edu/stable/user/yeddebba/proxy/37973/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 0
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 0 B
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;">Workers</h3>
        </summary>



    </details>
</div>

        </details>
    </div>
</div>
            </details>


    </div>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_depth_section</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span><span class="n">cntf</span><span class="p">,</span><span class="n">lev</span><span class="p">,</span><span class="n">clr</span><span class="p">,</span><span class="n">units</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">coords</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">fsx</span><span class="p">,</span><span class="n">lw</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">cb_on</span><span class="p">,</span><span class="n">profile</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cntf</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span> 
        <span class="n">cs</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">lev</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cb_on</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
            <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span><span class="c1">#, aspect=20)  </span>
<span class="c1">#             cb.ax.set_title(units,fontsize=fs-1,pad=0.2)</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.06</span><span class="p">))</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cntf</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span> <span class="n">cs</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">lev</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="n">alp</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span> <span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">();</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">profile</span><span class="o">==</span><span class="s1">&#39;lon&#39;</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Latitude ($^</span><span class="si">{o}</span><span class="s1">$N)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">profile</span><span class="o">==</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Longitude ($^</span><span class="si">{o}</span><span class="s1">$E)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
    <span class="k">return</span> <span class="n">ax</span> 

<span class="k">def</span> <span class="nf">plot_cmap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span><span class="n">vmn</span><span class="p">,</span> <span class="n">vmx</span><span class="p">,</span> <span class="n">stp</span><span class="p">,</span> <span class="n">clr</span><span class="p">,</span><span class="n">units</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">coor</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">fsx</span><span class="p">,</span><span class="n">lon_lab</span><span class="p">,</span><span class="n">lat_lab</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">coor</span><span class="p">,</span><span class="n">crs</span><span class="o">=</span><span class="n">cartopy</span><span class="o">.</span><span class="n">crs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">pc</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span><span class="n">lat</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">vmn</span><span class="p">,</span><span class="n">vmx</span><span class="p">,</span><span class="n">stp</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">clr</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span> <span class="c1">#, </span>
    <span class="n">land</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cartopy</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;land&#39;</span><span class="p">,</span> <span class="s1">&#39;10m&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">))</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">pc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span><span class="c1">#, aspect=20)  </span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">1.06</span><span class="p">))</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">fsx</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">};</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">fsx</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">};</span> 
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylabels_right</span><span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">xlines</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylines</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lon_lab</span><span class="p">);</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lat_lab</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span> <span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
    <span class="k">return</span> <span class="n">ax</span>


<span class="c1">### XGCM Commands:</span>
<span class="c1"># grid.integrate(dst.TRAC03.isel(time=0), &#39;Z&#39;)</span>
<span class="c1"># grid.integrate(dst.TRAC03.isel(time=0), [&#39;X&#39;, &#39;Y&#39;])</span>
<span class="c1"># grid.integrate(dsl.TRAC03, [&#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;])</span>
<span class="c1"># grid.average(dst.TRAC03.isel(time=0), [&#39;Z&#39;])</span>
<span class="c1"># grid.average(dsv.UVEL.isel(time=0), [&#39;X&#39;,&#39;Y&#39;])</span>
<span class="c1"># grid.cumint(-grid.integrate(dsv.UVEL.isel(time=0),&#39;Z&#39;),&#39;Y&#39;, boundary=&#39;fill&#39;) </span>
<span class="c1"># # grid.cumsum( -grid.integrate(dsv.UVEL.isel(time=4),&#39;Z&#39;) * dsv.dyG, &#39;Y&#39;, boundary=&#39;fill&#39;)</span>
<span class="c1"># uvel_l = grid.interp(dsv.UVEL,&#39;Z&#39;)</span>
<span class="c1"># grid.derivative(uvel_l.isel(time=0),&#39;Z&#39;) </span>
<span class="c1"># # grid.diff( uvel_l, &#39;Z&#39; ) / ds.drW</span>


<span class="k">def</span> <span class="nf">mitgcm_grid</span><span class="p">(</span><span class="n">dsr</span><span class="p">):</span>
    <span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;drW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsr</span><span class="o">.</span><span class="n">hFacW</span> <span class="o">*</span> <span class="n">dsr</span><span class="o">.</span><span class="n">drF</span> <span class="c1">#vertical cell size at u point</span>
    <span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;drS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsr</span><span class="o">.</span><span class="n">hFacS</span> <span class="o">*</span> <span class="n">dsr</span><span class="o">.</span><span class="n">drF</span> <span class="c1">#vertical cell size at v point</span>
    <span class="n">dsr</span><span class="p">[</span><span class="s1">&#39;drC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dsr</span><span class="o">.</span><span class="n">hFacC</span> <span class="o">*</span> <span class="n">dsr</span><span class="o">.</span><span class="n">drF</span> <span class="c1">#vertical cell size at tracer point</span>

    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,):</span> <span class="p">[</span><span class="s1">&#39;dxC&#39;</span><span class="p">,</span> <span class="s1">&#39;dxG&#39;</span><span class="p">],</span> <span class="c1"># X distances</span>
        <span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">,):</span> <span class="p">[</span><span class="s1">&#39;dyC&#39;</span><span class="p">,</span> <span class="s1">&#39;dyG&#39;</span><span class="p">],</span> <span class="c1"># Y distances</span>
        <span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">,):</span> <span class="p">[</span><span class="s1">&#39;drW&#39;</span><span class="p">,</span> <span class="s1">&#39;drS&#39;</span><span class="p">,</span> <span class="s1">&#39;drC&#39;</span><span class="p">],</span> <span class="c1"># Z distances</span>
        <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="s1">&#39;Y&#39;</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;rA&#39;</span><span class="p">,</span> <span class="s1">&#39;rAs&#39;</span><span class="p">,</span> <span class="s1">&#39;rAw&#39;</span><span class="p">]</span> <span class="c1"># Areas</span>
    <span class="p">}</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span><span class="n">dsr</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">,</span><span class="n">periodic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">grid</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="load-monthly-mean-budget-terms-and-take-the-longterm-mean">
<h1>Load Monthly Mean Budget Terms and take the longterm mean<a class="headerlink" href="#load-monthly-mean-budget-terms-and-take-the-longterm-mean" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span> <span class="n">S</span><span class="o">=-</span><span class="mi">5</span>
<span class="n">W</span><span class="o">=</span><span class="mi">160</span><span class="p">;</span> <span class="n">E</span><span class="o">=</span><span class="mi">100</span>
<span class="n">Du</span><span class="o">=-</span><span class="mi">50</span><span class="p">;</span> <span class="n">Dl</span><span class="o">=-</span><span class="mi">150</span><span class="p">;</span> <span class="n">Ds</span><span class="o">=</span><span class="mi">0</span>
<span class="n">rho_u</span><span class="o">=</span><span class="mf">1024.0</span><span class="p">;</span> <span class="n">rho_d</span><span class="o">=</span><span class="mf">1026.0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dst</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/monthly/*O2_monthly.nc&#39;</span><span class="p">)</span>
<span class="n">dst</span><span class="p">[</span><span class="s1">&#39;rVOL&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dst</span><span class="o">.</span><span class="n">drF</span><span class="o">*</span><span class="n">dst</span><span class="o">.</span><span class="n">rA</span><span class="o">*</span><span class="n">dst</span><span class="o">.</span><span class="n">hFacC</span>
<span class="n">dsw</span><span class="o">=</span><span class="n">dst</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;month&#39;</span><span class="p">)</span>
<span class="n">dsw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:    (Z: 30, YC: 204, XC: 1128)
Coordinates:
  * Z          (Z) float32 -2.5 -7.5 -12.5 -17.5 ... -448.2 -490.9 -538.7 -591.7
  * YC         (YC) float32 -16.92 -16.75 -16.58 -16.42 ... 16.58 16.75 16.92
  * XC         (XC) float32 104.1 104.2 104.4 104.6 ... 291.4 291.6 291.8 291.9
    rA         (YC, XC) float32 dask.array&lt;chunksize=(204, 1128), meta=np.ndarray&gt;
    Depth      (YC, XC) float32 dask.array&lt;chunksize=(204, 1128), meta=np.ndarray&gt;
    maskInC    (YC, XC) int8 dask.array&lt;chunksize=(204, 1128), meta=np.ndarray&gt;
    hFacC      (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    maskC      (Z, YC, XC) int8 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    maskCtrlC  (Z, YC, XC) int8 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    drF        (Z) float32 dask.array&lt;chunksize=(30,), meta=np.ndarray&gt;
    rhoRef     (Z) float32 dask.array&lt;chunksize=(30,), meta=np.ndarray&gt;
Data variables: (12/21)
    U_O2       (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    V_O2       (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    W_O2       (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    DIVm       (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    U_dO2      (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    V_dO2      (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    ...         ...
    adv_v_O2   (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    bio_O2     (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    dif_v_O2   (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    surf_O2    (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    tend_O2    (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;
    rVOL       (Z, YC, XC) float32 dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7d33041d-6c7b-41ef-9fd2-ae18d8d7cc11' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7d33041d-6c7b-41ef-9fd2-ae18d8d7cc11' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>Z</span>: 30</li><li><span class='xr-has-index'>YC</span>: 204</li><li><span class='xr-has-index'>XC</span>: 1128</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-ae84ddd0-399b-4ca9-aae0-8d74076cb507' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ae84ddd0-399b-4ca9-aae0-8d74076cb507' class='xr-section-summary' >Coordinates: <span>(11)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>Z</span></div><div class='xr-var-dims'>(Z)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-2.5 -7.5 -12.5 ... -538.7 -591.7</div><input id='attrs-4ab0da7a-76ca-442f-85c5-89b63c71cc41' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4ab0da7a-76ca-442f-85c5-89b63c71cc41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a696701-4001-473c-aeac-e25f3d832804' class='xr-var-data-in' type='checkbox'><label for='data-6a696701-4001-473c-aeac-e25f3d832804' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>depth</dd><dt><span>long_name :</span></dt><dd>vertical coordinate of cell center</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>positive :</span></dt><dd>down</dd><dt><span>axis :</span></dt><dd>Z</dd></dl></div><div class='xr-var-data'><pre>array([  -2.5    ,   -7.5    ,  -12.5    ,  -17.5    ,  -23.     ,  -29.5    ,
        -37.     ,  -45.5    ,  -55.     ,  -65.5    ,  -76.9143 ,  -89.25715,
       -102.82855, -117.82855, -134.25716, -152.1143 , -171.4    , -192.1143 ,
       -214.25716, -237.82855, -262.82855, -289.25714, -317.1143 , -346.4    ,
       -376.4    , -409.73334, -448.23334, -490.9    , -538.73334, -591.73334],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>YC</span></div><div class='xr-var-dims'>(YC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-16.92 -16.75 ... 16.75 16.92</div><input id='attrs-db6f6167-3d9c-458f-b866-9e5b2fdc3570' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-db6f6167-3d9c-458f-b866-9e5b2fdc3570' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-551f3713-3670-4f55-a394-5c1f785c53e0' class='xr-var-data-in' type='checkbox'><label for='data-551f3713-3670-4f55-a394-5c1f785c53e0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>coordinate :</span></dt><dd>YC XC</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([-16.916666, -16.75    , -16.583334, ...,  16.583334,  16.75    ,
        16.916666], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>XC</span></div><div class='xr-var-dims'>(XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>104.1 104.2 104.4 ... 291.8 291.9</div><input id='attrs-831be3dd-66b9-4ee5-b3d9-1ad7d8473ff7' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-831be3dd-66b9-4ee5-b3d9-1ad7d8473ff7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c6b87dc-e14b-4c44-b6f3-72ee61f4be6a' class='xr-var-data-in' type='checkbox'><label for='data-8c6b87dc-e14b-4c44-b6f3-72ee61f4be6a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>coordinate :</span></dt><dd>YC XC</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([104.083336, 104.25    , 104.416664, ..., 291.58334 , 291.75    ,
       291.91666 ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rA</span></div><div class='xr-var-dims'>(YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(204, 1128), meta=np.ndarray&gt;</div><input id='attrs-0c5af07a-e16b-4b9a-a2ed-e23c47917837' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c5af07a-e16b-4b9a-a2ed-e23c47917837' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b7245a9a-549a-4068-83bd-86f335d9dfd1' class='xr-var-data-in' type='checkbox'><label for='data-b7245a9a-549a-4068-83bd-86f335d9dfd1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>cell_area</dd><dt><span>long_name :</span></dt><dd>cell area</dd><dt><span>units :</span></dt><dd>m2</dd><dt><span>coordinate :</span></dt><dd>YC XC</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 898.88 kiB </td>
                        <td> 898.88 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (204, 1128) </td>
                        <td> (204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 40 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="91" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="41" x2="120" y2="41" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="41" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="41" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,41.57366753074273 0.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="61.573668" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="140.000000" y="20.786834" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,20.786834)">204</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Depth</span></div><div class='xr-var-dims'>(YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(204, 1128), meta=np.ndarray&gt;</div><input id='attrs-b5dbc129-e9fb-4a79-8a4b-c675403d4239' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b5dbc129-e9fb-4a79-8a4b-c675403d4239' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9feeaaca-1f1e-4124-af23-d9fe588556bf' class='xr-var-data-in' type='checkbox'><label for='data-9feeaaca-1f1e-4124-af23-d9fe588556bf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>ocean_depth</dd><dt><span>long_name :</span></dt><dd>ocean depth</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>coordinate :</span></dt><dd>XC YC</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 898.88 kiB </td>
                        <td> 898.88 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (204, 1128) </td>
                        <td> (204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 40 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="91" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="41" x2="120" y2="41" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="41" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="41" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,41.57366753074273 0.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="61.573668" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="140.000000" y="20.786834" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,20.786834)">204</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>maskInC</span></div><div class='xr-var-dims'>(YC, XC)</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(204, 1128), meta=np.ndarray&gt;</div><input id='attrs-86c69176-33d1-405a-8902-c1200ae3022f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-86c69176-33d1-405a-8902-c1200ae3022f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-263e9df8-79cc-4c04-b8c8-4cbf2f94b30f' class='xr-var-data-in' type='checkbox'><label for='data-263e9df8-79cc-4c04-b8c8-4cbf2f94b30f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>interior_2d_mask</dd><dt><span>long_name :</span></dt><dd>OBCS 2D interior mask at tracer location, zero beyond OB</dd><dt><span>units :</span></dt><dd></dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 224.72 kiB </td>
                        <td> 224.72 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (204, 1128) </td>
                        <td> (204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 35 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> int8 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="91" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="41" x2="120" y2="41" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="41" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="41" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,41.57366753074273 0.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="61.573668" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="140.000000" y="20.786834" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,20.786834)">204</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>hFacC</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-84c000f5-60da-4930-9af4-74f4a952957e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-84c000f5-60da-4930-9af4-74f4a952957e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-617d6b72-7b1f-4a26-93e2-539bf475dfff' class='xr-var-data-in' type='checkbox'><label for='data-617d6b72-7b1f-4a26-93e2-539bf475dfff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>cell_vertical_fraction</dd><dt><span>long_name :</span></dt><dd>vertical fraction of open cell</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 40 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>maskC</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-f98e15a3-f698-40dc-9cd2-68b4177a8696' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f98e15a3-f698-40dc-9cd2-68b4177a8696' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-962fdce6-fa0f-4649-80d7-5a37775ff40a' class='xr-var-data-in' type='checkbox'><label for='data-962fdce6-fa0f-4649-80d7-5a37775ff40a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>sea_binary_mask_at_t_location</dd><dt><span>long_name :</span></dt><dd>mask denoting wet point at center</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 6.58 MiB </td>
                        <td> 6.58 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 35 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> int8 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>maskCtrlC</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>int8</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-4619154d-645d-45ba-a229-e521eddb95f3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4619154d-645d-45ba-a229-e521eddb95f3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-78990e85-c57e-4ec1-b3ed-fd1e73e8171c' class='xr-var-data-in' type='checkbox'><label for='data-78990e85-c57e-4ec1-b3ed-fd1e73e8171c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>ctrl_vector_3d_mask</dd><dt><span>long_name :</span></dt><dd>CTRL 3D mask where ctrl vector is active at tracer location</dd><dt><span>units :</span></dt><dd></dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 6.58 MiB </td>
                        <td> 6.58 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 35 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> int8 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>drF</span></div><div class='xr-var-dims'>(Z)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30,), meta=np.ndarray&gt;</div><input id='attrs-1ced0932-5d96-4524-bc25-d4a3a0161081' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1ced0932-5d96-4524-bc25-d4a3a0161081' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1c15bd36-3b80-47e0-ae76-c957d58d6c80' class='xr-var-data-in' type='checkbox'><label for='data-1c15bd36-3b80-47e0-ae76-c957d58d6c80' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>cell_z_size</dd><dt><span>long_name :</span></dt><dd>cell z size</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 120 B </td>
                        <td> 120 B </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30,) </td>
                        <td> (30,) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 40 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="82" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="32" x2="120" y2="32" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="32" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="32" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,32.02435249410096 0.0,32.02435249410096" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="52.024352" font-size="1.0rem" font-weight="100" text-anchor="middle" >30</text>
  <text x="140.000000" y="16.012176" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,16.012176)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rhoRef</span></div><div class='xr-var-dims'>(Z)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30,), meta=np.ndarray&gt;</div><input id='attrs-96003f11-38c2-4b01-bc6f-3d36c39cc62b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-96003f11-38c2-4b01-bc6f-3d36c39cc62b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b379539d-2ead-418f-8ae2-2de53354dd50' class='xr-var-data-in' type='checkbox'><label for='data-b379539d-2ead-418f-8ae2-2de53354dd50' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>reference_density_profile</dd><dt><span>long_name :</span></dt><dd>1D, vertical reference density profile</dd><dt><span>coordinate :</span></dt><dd>Z</dd><dt><span>units :</span></dt><dd>kg m-3</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 120 B </td>
                        <td> 120 B </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30,) </td>
                        <td> (30,) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 40 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="82" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="32" x2="120" y2="32" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="32" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="32" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,32.02435249410096 0.0,32.02435249410096" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="52.024352" font-size="1.0rem" font-weight="100" text-anchor="middle" >30</text>
  <text x="140.000000" y="16.012176" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,16.012176)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-329c6fe8-b516-4680-a166-6473d0ceb6ff' class='xr-section-summary-in' type='checkbox'  ><label for='section-329c6fe8-b516-4680-a166-6473d0ceb6ff' class='xr-section-summary' >Data variables: <span>(21)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>U_O2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-fd306010-8953-4b81-9ed0-69c4f70e5df2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fd306010-8953-4b81-9ed0-69c4f70e5df2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ec29685-37da-46d7-836f-1b4729cdae40' class='xr-var-data-in' type='checkbox'><label for='data-6ec29685-37da-46d7-836f-1b4729cdae40' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>V_O2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-dbd27f82-afc2-48e2-a101-80a66d2a9bcb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dbd27f82-afc2-48e2-a101-80a66d2a9bcb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-53160dbc-cce2-4ebf-b806-1f010ec1876d' class='xr-var-data-in' type='checkbox'><label for='data-53160dbc-cce2-4ebf-b806-1f010ec1876d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>W_O2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-425419b9-1d99-4558-a6c0-75f0b4a71c4f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-425419b9-1d99-4558-a6c0-75f0b4a71c4f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c4c16839-a25e-45ca-8fa8-6f2babdad859' class='xr-var-data-in' type='checkbox'><label for='data-c4c16839-a25e-45ca-8fa8-6f2babdad859' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DIVm</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-b0005304-be02-4196-ace5-41059b914518' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b0005304-be02-4196-ace5-41059b914518' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e501d7c-0cc4-4739-8e51-f49dd5890ba6' class='xr-var-data-in' type='checkbox'><label for='data-1e501d7c-0cc4-4739-8e51-f49dd5890ba6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>U_dO2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-c86ed44d-e03b-4bde-aa42-2a355a304ca1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c86ed44d-e03b-4bde-aa42-2a355a304ca1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85675376-6eec-47fb-bfbc-18c718910d76' class='xr-var-data-in' type='checkbox'><label for='data-85675376-6eec-47fb-bfbc-18c718910d76' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>V_dO2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-31118603-e8c3-4401-ad35-03b982b5e28c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-31118603-e8c3-4401-ad35-03b982b5e28c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12bc0afa-f0eb-40f6-adbc-e2836e4771d0' class='xr-var-data-in' type='checkbox'><label for='data-12bc0afa-f0eb-40f6-adbc-e2836e4771d0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>O2_dW</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-110bc2de-f9e8-4b29-a51b-063e30a2a36a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-110bc2de-f9e8-4b29-a51b-063e30a2a36a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fdbd93a1-db3f-49c0-89b4-77a4c6d68dd8' class='xr-var-data-in' type='checkbox'><label for='data-fdbd93a1-db3f-49c0-89b4-77a4c6d68dd8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>W_dO2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-e57b1732-10ee-4d89-8a00-11af5075e2f0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e57b1732-10ee-4d89-8a00-11af5075e2f0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4796ffca-0f56-4498-8ee3-184111e79dee' class='xr-var-data-in' type='checkbox'><label for='data-4796ffca-0f56-4498-8ee3-184111e79dee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DIVd</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-d4fcd119-4a74-45b0-bff0-4d301a7f8599' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d4fcd119-4a74-45b0-bff0-4d301a7f8599' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-51f19696-30e9-4848-a3b1-17e01eb58e55' class='xr-var-data-in' type='checkbox'><label for='data-51f19696-30e9-4848-a3b1-17e01eb58e55' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DIVp</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-32fc393b-48a3-4281-be17-f44a1a99b4fc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-32fc393b-48a3-4281-be17-f44a1a99b4fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85b39d4d-2db5-45fa-aa19-60d9a9f76cf1' class='xr-var-data-in' type='checkbox'><label for='data-85b39d4d-2db5-45fa-aa19-60d9a9f76cf1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>DIVdp</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-eb46801f-c76e-4998-8b8d-2c7125e077c3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-eb46801f-c76e-4998-8b8d-2c7125e077c3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6b45b300-e68f-498a-a12a-8ec79b4e7e15' class='xr-var-data-in' type='checkbox'><label for='data-6b45b300-e68f-498a-a12a-8ec79b4e7e15' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Up_dO2p</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-687f3b4e-5f68-4c6b-b10e-160e967f1ee7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-687f3b4e-5f68-4c6b-b10e-160e967f1ee7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49497363-0d54-4081-861f-27c6f77e1fdf' class='xr-var-data-in' type='checkbox'><label for='data-49497363-0d54-4081-861f-27c6f77e1fdf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Wp_dO2p</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-56d990c1-0ff8-4c9b-83ac-7e9d508bd082' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-56d990c1-0ff8-4c9b-83ac-7e9d508bd082' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f16557ab-245d-4071-ad54-670ca7005075' class='xr-var-data-in' type='checkbox'><label for='data-f16557ab-245d-4071-ad54-670ca7005075' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>TRAC03</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-c73c3532-42cf-4b00-8315-076f66f35a4b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c73c3532-42cf-4b00-8315-076f66f35a4b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-65ce1b19-11c0-4927-9821-827c264da289' class='xr-var-data-in' type='checkbox'><label for='data-65ce1b19-11c0-4927-9821-827c264da289' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>adv_h_O2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-1982e175-3c7c-4120-b5da-26c23bf8868f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1982e175-3c7c-4120-b5da-26c23bf8868f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6b4232f2-fcb5-4246-9f37-30c6511c71ca' class='xr-var-data-in' type='checkbox'><label for='data-6b4232f2-fcb5-4246-9f37-30c6511c71ca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>adv_v_O2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-2a177417-45ec-45a8-bbd7-c3aae37c7dae' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2a177417-45ec-45a8-bbd7-c3aae37c7dae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b668c901-2e46-4eca-94fc-8e8f59de5032' class='xr-var-data-in' type='checkbox'><label for='data-b668c901-2e46-4eca-94fc-8e8f59de5032' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bio_O2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-b9c89876-a95b-45c2-b0c9-7cfa9f89a612' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b9c89876-a95b-45c2-b0c9-7cfa9f89a612' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4628755d-b9b9-45bb-a1fd-e4837ee89a7f' class='xr-var-data-in' type='checkbox'><label for='data-4628755d-b9b9-45bb-a1fd-e4837ee89a7f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dif_v_O2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-c5df6fbe-063a-437c-a74c-70fbdff68801' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c5df6fbe-063a-437c-a74c-70fbdff68801' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2218c759-d554-4204-b9b6-775276fcdcca' class='xr-var-data-in' type='checkbox'><label for='data-2218c759-d554-4204-b9b6-775276fcdcca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>surf_O2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-47d07d42-902e-44c5-b32a-e4bae7eae93e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-47d07d42-902e-44c5-b32a-e4bae7eae93e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9bc7f64a-db5e-4424-a0c3-ad860833743a' class='xr-var-data-in' type='checkbox'><label for='data-9bc7f64a-db5e-4424-a0c3-ad860833743a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tend_O2</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-5408abe1-1c7d-4dc9-8598-470ec2e2016e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5408abe1-1c7d-4dc9-8598-470ec2e2016e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0b8860b1-f625-4c82-93fe-cb845754c375' class='xr-var-data-in' type='checkbox'><label for='data-0b8860b1-f625-4c82-93fe-cb845754c375' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 4 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rVOL</span></div><div class='xr-var-dims'>(Z, YC, XC)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(30, 204, 1128), meta=np.ndarray&gt;</div><input id='attrs-d4cb351e-01b3-4184-a00e-d08fb9f45c81' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d4cb351e-01b3-4184-a00e-d08fb9f45c81' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e51a8eb9-5483-4456-a853-d4f5c678be5d' class='xr-var-data-in' type='checkbox'><label for='data-e51a8eb9-5483-4456-a853-d4f5c678be5d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 26.33 MiB </td>
                        <td> 26.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (30, 204, 1128) </td>
                        <td> (30, 204, 1128) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 125 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="198" height="109" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="10" y1="41" x2="28" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="41" style="stroke-width:2" />
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 28.043921315435163,18.043921315435163 28.043921315435163,59.617588846177895 10.0,41.57366753074273" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="28" y2="18" style="stroke-width:2" />
  <line x1="130" y1="0" x2="148" y2="18" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 148.04392131543517,18.043921315435163 28.043921315435163,18.043921315435163" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="28" y1="18" x2="148" y2="18" style="stroke-width:2" />
  <line x1="28" y1="59" x2="148" y2="59" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="28" y1="18" x2="28" y2="59" style="stroke-width:2" />
  <line x1="148" y1="18" x2="148" y2="59" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="28.043921315435163,18.043921315435163 148.04392131543517,18.043921315435163 148.04392131543517,59.617588846177895 28.043921315435163,59.617588846177895" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="88.043921" y="79.617589" font-size="1.0rem" font-weight="100" text-anchor="middle" >1128</text>
  <text x="168.043921" y="38.830755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,168.043921,38.830755)">204</text>
  <text x="9.021961" y="70.595628" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,9.021961,70.595628)">30</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-6f5b4c2a-31f1-454d-8660-592f35db01df' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6f5b4c2a-31f1-454d-8660-592f35db01df' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsv</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/variables_201?.nc&#39;</span><span class="p">,</span><span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="n">dsb</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/budgets_201?.nc&#39;</span><span class="p">,</span><span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>
<span class="n">EKE</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/EKE_2010_2017.nc&#39;</span><span class="p">)[</span><span class="s1">&#39;__xarray_dataarray_variable__&#39;</span><span class="p">]</span>
<span class="n">dso</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/rho_O2_5day_201?.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">O2_rho</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/intergals/O2_24_26.nc&#39;</span><span class="p">)[</span><span class="s1">&#39;__xarray_dataarray_variable__&#39;</span><span class="p">]</span>
<span class="n">O2_rho</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;__xarray_dataarray_variable__&#x27; (time: 584)&gt;
dask.array&lt;open_dataset-fd164e11725706c79051abf94a3fd884__xarray_dataarray_variable__, shape=(584,), dtype=float32, chunksize=(584,), chunktype=numpy.ndarray&gt;
Coordinates:
    iter     (time) int32 dask.array&lt;chunksize=(584,), meta=np.ndarray&gt;
  * time     (time) datetime64[ns] 2010-01-04 2010-01-09 ... 2017-12-28</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'__xarray_dataarray_variable__'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 584</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-4446c7e0-789d-4ca6-abfd-26dd035f10d8' class='xr-array-in' type='checkbox' checked><label for='section-4446c7e0-789d-4ca6-abfd-26dd035f10d8' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(584,), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 2.28 kiB </td>
                        <td> 2.28 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (584,) </td>
                        <td> (584,) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >584</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-6f11f049-a37a-4a2a-bb1e-507d4a26e7b7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6f11f049-a37a-4a2a-bb1e-507d4a26e7b7' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>iter</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(584,), meta=np.ndarray&gt;</div><input id='attrs-004fd54f-f0d0-41f8-b749-9d4c2cd75edd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-004fd54f-f0d0-41f8-b749-9d4c2cd75edd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-03a2654f-b595-4106-bab6-6b2526cb523a' class='xr-var-data-in' type='checkbox'><label for='data-03a2654f-b595-4106-bab6-6b2526cb523a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>timestep</dd><dt><span>long_name :</span></dt><dd>model timestep number</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 2.28 kiB </td>
                        <td> 2.28 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (584,) </td>
                        <td> (584,) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> int32 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >584</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2010-01-04 ... 2017-12-28</div><input id='attrs-b1408649-630c-4fdf-9000-07d8c062cefd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b1408649-630c-4fdf-9000-07d8c062cefd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0df12ac9-a385-488b-aff6-05f42d36abaf' class='xr-var-data-in' type='checkbox'><label for='data-0df12ac9-a385-488b-aff6-05f42d36abaf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2010-01-04T00:00:00.000000000&#x27;, &#x27;2010-01-09T00:00:00.000000000&#x27;,
       &#x27;2010-01-14T00:00:00.000000000&#x27;, ..., &#x27;2017-12-18T00:00:00.000000000&#x27;,
       &#x27;2017-12-23T00:00:00.000000000&#x27;, &#x27;2017-12-28T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9a2b3610-f24d-45ae-b4a4-3f11393e58c3' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9a2b3610-f24d-45ae-b4a4-3f11393e58c3' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plot-longterm-mean-budget">
<h1>Plot Longterm Mean Budget<a class="headerlink" href="#plot-longterm-mean-budget" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">12</span><span class="p">;</span> <span class="n">fsx</span><span class="o">=</span><span class="mi">8</span>
<span class="n">EE</span><span class="o">=-</span><span class="mf">200.0</span><span class="p">;</span> <span class="n">WW</span><span class="o">=-</span><span class="mf">70.1</span><span class="p">;</span> <span class="n">SS</span><span class="o">=-</span><span class="mf">17.0</span><span class="p">;</span> <span class="n">NN</span><span class="o">=</span><span class="mf">17.1</span>
<span class="n">coor</span><span class="o">=</span><span class="p">[</span><span class="n">EE</span><span class="p">,</span><span class="n">WW</span><span class="p">,</span><span class="n">SS</span><span class="p">,</span><span class="n">NN</span><span class="p">];</span> <span class="n">CL</span><span class="o">=</span><span class="mf">215.0</span> <span class="c1"># central longtiude </span>
<span class="n">lon_lab</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">EE</span><span class="p">,</span><span class="n">WW</span><span class="p">,</span><span class="mi">20</span><span class="p">)])</span>
<span class="n">lat_lab</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">SS</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="n">clr_o2</span><span class="o">=</span><span class="s1">&#39;NegPos&#39;</span>
<span class="n">omz_clr</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>
<span class="n">odz_clr</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span>

<span class="n">VAR</span><span class="o">=</span> <span class="p">[((</span><span class="n">dsw</span><span class="o">.</span><span class="n">tend_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)),</span>
      <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">adv_h_O2</span><span class="o">+</span><span class="n">dsw</span><span class="o">.</span><span class="n">adv_v_O2</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)),</span>
      <span class="p">((</span><span class="o">-</span><span class="n">dsw</span><span class="o">.</span><span class="n">DIVd</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)),</span>      
      <span class="p">(((</span><span class="o">-</span><span class="n">dsw</span><span class="o">.</span><span class="n">DIVdp</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)),</span>
      <span class="p">((</span><span class="o">-</span><span class="n">dsw</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)),</span>
      <span class="p">((</span><span class="n">dsw</span><span class="o">.</span><span class="n">bio_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)),</span>
     <span class="p">]</span>

<span class="n">units</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mol.m$^{-3}$.s$^{-1}$&#39;</span><span class="p">]</span>
<span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{t}</span><span class="s1">}}$ &#39;</span><span class="p">,</span> 
     <span class="sa">r</span><span class="s2">&quot;$-\overline{U.\nabla</span><span class="si">{O_2}</span><span class="s2">}$&quot;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{U}</span><span class="s1">.\nabla{\overline</span><span class="si">{O_2}</span><span class="s1">}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s2">&quot;$-\overline{U&#39;.\nabla{O_2&#39;}}$&quot;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$\overline{\frac{\partial</span><span class="si">{}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}k.\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$\overline{J(O_2)}$ &#39;</span><span class="p">]</span>


<span class="n">clrs</span><span class="o">=</span><span class="p">[</span><span class="n">clr_o2</span><span class="p">]</span>
<span class="n">lmax</span><span class="o">=</span><span class="mf">5e-9</span>
<span class="n">lmin</span><span class="o">=-</span><span class="n">lmax</span>
<span class="n">lstp</span><span class="o">=</span><span class="n">lmax</span><span class="o">*</span><span class="mf">0.5e-1</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">rng</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)):</span><span class="c1">#len(VAR))):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_cmap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">XC</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">YC</span><span class="p">,</span> <span class="n">VAR</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">lmin</span><span class="p">,</span> <span class="n">lmax</span><span class="p">,</span> <span class="n">lstp</span><span class="p">,</span>
                   <span class="n">clrs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">title</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">coor</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">fsx</span><span class="p">,</span> <span class="n">lon_lab</span><span class="p">,</span><span class="n">lat_lab</span><span class="p">)</span>
<span class="c1">#     (dv.UVEL).isel(z_t=15).plot.contour(colors=&#39;black&#39;,linewidths=0.7,levels=np.arange(-150,150,50))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">XC</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">YC</span><span class="p">,</span> <span class="n">dsw</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">omz_clr</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="mf">60.1</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>    
    <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">XC</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">YC</span><span class="p">,</span> <span class="n">dsw</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="n">odz_clr</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mf">20.1</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> 
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> 
        <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">XC</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">YC</span><span class="p">,</span> <span class="n">dsw</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">200.1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span> 
    <span class="n">gl</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">fsx</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">};</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">fsx</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">};</span> 
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylabels_right</span><span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">xlines</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylines</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lon_lab</span><span class="p">);</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lat_lab</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span> <span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 6/6 [01:04&lt;00:00, 10.76s/it]
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_11_1.png" src="../../../_images/Analysis_O2_Budget_MITgcm_11_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>

<span class="n">fs</span><span class="o">=</span><span class="mi">14</span><span class="p">;</span> <span class="n">fsx</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span> 
<span class="n">SS</span><span class="o">=-</span><span class="mi">17</span><span class="p">;</span> <span class="n">NN</span><span class="o">=</span><span class="mi">17</span>
<span class="n">tops</span><span class="o">=</span><span class="mf">0.</span> <span class="p">;</span> <span class="n">bots</span><span class="o">=</span><span class="mf">500.</span><span class="p">;</span> 
<span class="n">coords</span><span class="o">=</span><span class="p">[[</span><span class="n">bots</span><span class="p">,</span><span class="n">tops</span><span class="p">],[</span><span class="n">SS</span><span class="p">,</span><span class="n">NN</span><span class="p">]]</span>
<span class="n">clr_o2</span><span class="o">=</span><span class="s1">&#39;NegPos&#39;</span>
<span class="n">omz_clr</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>
<span class="n">odz_clr</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span>
<span class="n">om_clr</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>

<span class="n">var</span><span class="o">=</span> <span class="p">[((</span><span class="n">dsw</span><span class="o">.</span><span class="n">tend_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>
      <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">adv_h_O2</span><span class="o">+</span><span class="n">dsw</span><span class="o">.</span><span class="n">adv_v_O2</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>
      <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">U_dO2</span><span class="o">+</span><span class="n">dsw</span><span class="o">.</span><span class="n">V_dO2</span><span class="o">+</span><span class="n">dsw</span><span class="o">.</span><span class="n">W_dO2</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>      
      <span class="p">((</span><span class="o">-</span><span class="n">dsw</span><span class="o">.</span><span class="n">DIVdp</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>      
      <span class="p">((</span><span class="o">-</span><span class="n">dsw</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>
      <span class="p">((</span><span class="n">dsw</span><span class="o">.</span><span class="n">bio_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>
     <span class="p">]</span>

<span class="n">cntf</span><span class="o">=</span> <span class="kc">True</span> <span class="p">;</span> <span class="n">cnt</span><span class="o">=</span> <span class="kc">False</span> 
<span class="n">units</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mol.m$^{-3}$.s$^{-1}$&#39;</span><span class="p">]</span>
<span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{t}</span><span class="s1">}}$ &#39;</span><span class="p">,</span> 
     <span class="sa">r</span><span class="s2">&quot;$-\overline{U.\nabla</span><span class="si">{O_2}</span><span class="s2">}$&quot;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{U}</span><span class="s1">.\nabla{\overline</span><span class="si">{O_2}</span><span class="s1">}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s2">&quot;$-\overline{U&#39;.\nabla{O_2&#39;}}$&quot;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$\overline{\frac{\partial</span><span class="si">{}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}k.\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$\overline{J(O_2)}$ &#39;</span><span class="p">]</span>

<span class="n">clr</span><span class="o">=</span><span class="p">[</span><span class="n">clr_o2</span><span class="p">]</span>
<span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="n">alp</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">cb_on</span><span class="o">=</span><span class="kc">True</span>

<span class="n">lo</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3e-9</span><span class="p">;</span> <span class="n">hi</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="p">;</span> <span class="n">hi2</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="p">;</span> <span class="n">dsc</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="o">*</span><span class="mf">0.5e-1</span>
<span class="n">y</span><span class="o">=</span><span class="n">dsw</span><span class="o">.</span><span class="n">YC</span>
<span class="n">z</span><span class="o">=</span> <span class="n">dsw</span><span class="o">.</span><span class="n">Z</span><span class="o">*-</span><span class="mi">1</span>

<span class="n">i</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span> <span class="n">j</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)):</span><span class="c1">#len(VAR))):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">j</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span>
    <span class="n">cax</span><span class="o">=</span> <span class="n">plot_depth_section</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">cntf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="o">+</span><span class="n">dsc</span><span class="p">,</span> <span class="n">dsc</span><span class="p">),</span>
                            <span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">title</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">coords</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">fsx</span><span class="p">,</span><span class="n">lw</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">cb_on</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
    <span class="n">pch</span><span class="o">=</span> <span class="n">cax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">})</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span>
                     <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">300.1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">pch</span><span class="o">=</span> <span class="n">cax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">})</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span>
                     <span class="n">colors</span><span class="o">=</span><span class="n">om_clr</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mf">200.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span>
    <span class="n">pch</span><span class="o">=</span> <span class="n">cax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">})</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span>
                     <span class="n">colors</span><span class="o">=</span><span class="n">omz_clr</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="mf">60.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span>
    <span class="c1"># pch= cax.contour(y, z,dsw.TRAC03.sel(XC=slice(360-W,360-E)).mean({&#39;XC&#39;})*1e3,</span>
    <span class="c1">#                  colors=odz_clr, alpha=1, linewidths=1, levels = np.arange(20,20.1,0.1))</span>
    
    
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 6/6 [00:31&lt;00:00,  5.25s/it]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;bound method Figure.tight_layout of &lt;Figure size 2500x700 with 12 Axes&gt;&gt;
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_12_2.png" src="../../../_images/Analysis_O2_Budget_MITgcm_12_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># fig = plt.figure(figsize=(25,7),dpi=100,)</span>
<span class="c1"># gs = fig.add_gridspec(nrows=2, ncols=3, left=0.05, right=0.95, wspace=0.2, hspace=0.4)</span>

<span class="n">fs</span><span class="o">=</span><span class="mi">14</span><span class="p">;</span> <span class="n">fsx</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span> 
<span class="n">SS</span><span class="o">=-</span><span class="mi">17</span><span class="p">;</span> <span class="n">NN</span><span class="o">=</span><span class="mi">17</span>
<span class="n">tops</span><span class="o">=</span><span class="mf">0.</span> <span class="p">;</span> <span class="n">bots</span><span class="o">=</span><span class="mf">500.</span><span class="p">;</span> 
<span class="n">coords</span><span class="o">=</span><span class="p">[[</span><span class="n">bots</span><span class="p">,</span><span class="n">tops</span><span class="p">],[</span><span class="n">SS</span><span class="p">,</span><span class="n">NN</span><span class="p">]]</span>
<span class="n">clr_o2</span><span class="o">=</span><span class="s1">&#39;NegPos&#39;</span>
<span class="n">omz_clr</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>
<span class="n">odz_clr</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span>
<span class="n">om_clr</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>

<span class="n">var</span><span class="o">=</span> <span class="p">[((</span><span class="n">dsw</span><span class="o">.</span><span class="n">tend_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>
      <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">adv_h_O2</span><span class="o">+</span><span class="n">dsw</span><span class="o">.</span><span class="n">adv_v_O2</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>
      <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">DIVd</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>        
      <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">U_dO2</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>      
      <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">V_dO2</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>      
      <span class="p">((</span><span class="o">-</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">W_dO2</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;XC&#39;</span><span class="p">)),</span>      
       <span class="p">]</span>

<span class="n">cntf</span><span class="o">=</span> <span class="kc">True</span> <span class="p">;</span> <span class="n">cnt</span><span class="o">=</span> <span class="kc">False</span> 
<span class="n">units</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mol.m$^{-3}$.s$^{-1}$&#39;</span><span class="p">]</span>
<span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{t}</span><span class="s1">}}$ &#39;</span><span class="p">,</span> 
     <span class="sa">r</span><span class="s2">&quot;$-\overline{U.\nabla</span><span class="si">{O_2}</span><span class="s2">}$&quot;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{U}</span><span class="s1">.\nabla{\overline</span><span class="si">{O_2}</span><span class="s1">}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{u}</span><span class="s1">.\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{x}</span><span class="s1">}}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{v}</span><span class="s1">.\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{y}</span><span class="s1">}}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{w}</span><span class="s1">.\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}}$ &#39;</span><span class="p">,]</span>

<span class="n">clr</span><span class="o">=</span><span class="p">[</span><span class="n">clr_o2</span><span class="p">]</span>
<span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="n">alp</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">cb_on</span><span class="o">=</span><span class="kc">True</span>

<span class="n">lo</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3e-9</span><span class="p">;</span> <span class="n">hi</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="p">;</span> <span class="n">hi2</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="p">;</span> <span class="n">dsc</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="o">*</span><span class="mf">0.5e-1</span>
<span class="n">y</span><span class="o">=</span><span class="n">dsw</span><span class="o">.</span><span class="n">YC</span>
<span class="n">z</span><span class="o">=</span> <span class="n">dsw</span><span class="o">.</span><span class="n">Z</span><span class="o">*-</span><span class="mi">1</span>

<span class="n">i</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span> <span class="n">j</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)):</span><span class="c1">#len(VAR))):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">j</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span>
    <span class="n">cax</span><span class="o">=</span> <span class="n">plot_depth_section</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">cntf</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="o">+</span><span class="n">dsc</span><span class="p">,</span> <span class="n">dsc</span><span class="p">),</span>
                            <span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">title</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">coords</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">fsx</span><span class="p">,</span><span class="n">lw</span><span class="p">,</span><span class="n">alp</span><span class="p">,</span><span class="n">cb_on</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
    <span class="n">pch</span><span class="o">=</span> <span class="n">cax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">})</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span>
                     <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">300.1</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">pch</span><span class="o">=</span> <span class="n">cax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">})</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span>
                     <span class="n">colors</span><span class="o">=</span><span class="n">om_clr</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mf">200.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span>
    <span class="n">pch</span><span class="o">=</span> <span class="n">cax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">})</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span>
                     <span class="n">colors</span><span class="o">=</span><span class="n">omz_clr</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="mf">60.1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">))</span>
    <span class="c1"># pch= cax.contour(y, z,dsw.TRAC03.sel(XC=slice(360-W,360-E)).mean({&#39;XC&#39;})*1e3,</span>
    <span class="c1">#                  colors=odz_clr, alpha=1, linewidths=1, levels = np.arange(20,20.1,0.1))</span>
    

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 6/6 [00:33&lt;00:00,  5.58s/it]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;bound method Figure.tight_layout of &lt;Figure size 2000x1000 with 12 Axes&gt;&gt;
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_13_2.png" src="../../../_images/Analysis_O2_Budget_MITgcm_13_2.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plot-seasonal-cycle">
<h1>Plot Seasonal Cycle<a class="headerlink" href="#plot-seasonal-cycle" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">do</span><span class="o">=</span><span class="p">((</span><span class="n">dst</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dswz</span><span class="o">=</span><span class="p">(((</span><span class="n">dst</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">}))</span><span class="o">/</span><span class="p">((</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">})))</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Uz</span><span class="o">=</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">UVEL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XG</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">({</span><span class="s1">&#39;XG&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">}))</span>
<span class="n">Uzm</span><span class="o">=</span><span class="n">Uz</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">Vz</span><span class="o">=</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">VVEL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YG</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YG&#39;</span><span class="p">}))</span>
<span class="n">Vzm</span><span class="o">=</span><span class="n">Vz</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">Wz</span><span class="o">=</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">WVEL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">}))</span>
<span class="n">Wzm</span><span class="o">=</span><span class="n">Wz</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">EKE_m</span><span class="o">=</span><span class="p">((</span><span class="n">EKE</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rA</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">}))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rA</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">}))</span>
<span class="n">EKE_mn</span><span class="o">=</span><span class="n">EKE_m</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">EKEz_m</span><span class="o">=</span><span class="p">((</span><span class="n">EKE</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rA</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">}))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rA</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">}))</span>
<span class="n">EKEz_mn</span><span class="o">=</span><span class="n">EKEz_m</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">fs</span><span class="o">=</span><span class="mi">14</span><span class="p">;</span> <span class="n">fsx</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span> 
<span class="n">SS</span><span class="o">=-</span><span class="mi">17</span><span class="p">;</span> <span class="n">NN</span><span class="o">=</span><span class="mi">17</span>
<span class="n">tops</span><span class="o">=</span><span class="mf">0.</span> <span class="p">;</span> <span class="n">bots</span><span class="o">=</span><span class="mf">500.</span><span class="p">;</span> 
<span class="n">coords</span><span class="o">=</span><span class="p">[[</span><span class="n">bots</span><span class="p">,</span><span class="n">tops</span><span class="p">],[</span><span class="n">SS</span><span class="p">,</span><span class="n">NN</span><span class="p">]]</span>
<span class="n">clr_o2</span><span class="o">=</span><span class="s1">&#39;NegPos&#39;</span>
<span class="n">omz_clr</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>
<span class="n">odz_clr</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span>
<span class="n">om_clr</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>

<span class="n">var</span><span class="o">=</span> <span class="p">[</span><span class="n">dswz</span><span class="o">.</span><span class="n">tend_O2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">adv_h_O2</span><span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">adv_v_O2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">DIVd</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">DIVdp</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="p">,</span>
      <span class="n">dswz</span><span class="o">.</span><span class="n">bio_O2</span><span class="p">,</span>
     <span class="p">]</span>

<span class="n">cntf</span><span class="o">=</span> <span class="kc">True</span> <span class="p">;</span> <span class="n">cnt</span><span class="o">=</span> <span class="kc">False</span> 
<span class="n">units</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mol.m$^{-3}$.s$^{-1}$&#39;</span><span class="p">]</span>
<span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{t}</span><span class="s1">}}$ &#39;</span><span class="p">,</span> 
     <span class="sa">r</span><span class="s2">&quot;$-\overline{U.\nabla</span><span class="si">{O_2}</span><span class="s2">}$&quot;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{U}</span><span class="s1">.\nabla{\overline</span><span class="si">{O_2}</span><span class="s1">}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s2">&quot;$-\overline{U&#39;.\nabla{O_2&#39;}}$&quot;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$\overline{\frac{\partial</span><span class="si">{}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}k.\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$\overline{J(O_2)}$ &#39;</span><span class="p">]</span>

<span class="n">clr</span><span class="o">=</span><span class="p">[</span><span class="n">clr_o2</span><span class="p">]</span>
<span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="n">alp</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">cb_on</span><span class="o">=</span><span class="kc">True</span>

<span class="n">lo</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3e-9</span><span class="p">;</span> <span class="n">hi</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="p">;</span> <span class="n">hi2</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="p">;</span> <span class="n">dsc</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="o">*</span><span class="mf">0.3e-1</span>
<span class="n">y</span><span class="o">=</span><span class="n">dswz</span><span class="o">.</span><span class="n">month</span>
<span class="n">z</span><span class="o">=</span> <span class="n">dswz</span><span class="o">.</span><span class="n">Z</span><span class="o">*-</span><span class="mi">1</span>

<span class="n">i</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span> <span class="n">j</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)):</span><span class="c1">#len(VAR))):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">j</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span>
    <span class="n">cs</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="o">+</span><span class="n">dsc</span><span class="p">,</span> <span class="n">dsc</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span><span class="c1">#, aspect=20)  </span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.06</span><span class="p">))</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
    <span class="c1"># cs= ax.contour(y,z,dso.transpose()*1e3,colors=&#39;k&#39;,linewidths=lw,alpha=alp)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">();</span> 
    <span class="c1"># ax.set_xlim(coords[1]); </span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span>


<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cs</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">Uzm</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span><span class="c1">#, aspect=20)  </span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.06</span><span class="p">))</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">();</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\overline</span><span class="si">{u}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">cs</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="n">Wzm</span><span class="o">.</span><span class="n">Zl</span><span class="p">,</span><span class="o">-</span><span class="n">Wzm</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">4.5e-6</span><span class="p">,</span><span class="mf">4.5e-6</span><span class="p">,</span><span class="mf">0.05e-6</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span><span class="c1">#, aspect=20)  </span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.06</span><span class="p">))</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">();</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\overline</span><span class="si">{w}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">cs</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">EKEz_mn</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="n">EKEz_mn</span><span class="o">.</span><span class="n">YC</span><span class="p">,</span><span class="n">EKEz_mn</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">*</span><span class="mf">1e4</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.6e3</span><span class="p">,</span><span class="mf">0.01e3</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;glacial&#39;</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span><span class="c1">#, aspect=20)  </span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;cm2/s2&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.06</span><span class="p">))</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
<span class="c1"># ax.set_ylim(coords[0]); ax.minorticks_on(); </span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude (ºN)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\overline</span><span class="si">{EKE}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 6/6 [00:00&lt;00:00,  7.30it/s]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;$\\overline{EKE}$&#39;)
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_19_2.png" src="../../../_images/Analysis_O2_Budget_MITgcm_19_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,)</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">fs</span><span class="o">=</span><span class="mi">14</span><span class="p">;</span> <span class="n">fsx</span><span class="o">=</span><span class="mi">8</span><span class="p">;</span> 
<span class="n">SS</span><span class="o">=-</span><span class="mi">17</span><span class="p">;</span> <span class="n">NN</span><span class="o">=</span><span class="mi">17</span>
<span class="n">tops</span><span class="o">=</span><span class="mf">0.</span> <span class="p">;</span> <span class="n">bots</span><span class="o">=</span><span class="mf">500.</span><span class="p">;</span> 
<span class="n">coords</span><span class="o">=</span><span class="p">[[</span><span class="n">bots</span><span class="p">,</span><span class="n">tops</span><span class="p">],[</span><span class="n">SS</span><span class="p">,</span><span class="n">NN</span><span class="p">]]</span>
<span class="n">clr_o2</span><span class="o">=</span><span class="s1">&#39;NegPos&#39;</span>
<span class="n">omz_clr</span><span class="o">=</span><span class="s1">&#39;green&#39;</span>
<span class="n">odz_clr</span><span class="o">=</span><span class="s1">&#39;lime&#39;</span>
<span class="n">om_clr</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span>

<span class="n">var</span><span class="o">=</span> <span class="p">[</span><span class="n">dswz</span><span class="o">.</span><span class="n">tend_O2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">adv_h_O2</span><span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">adv_v_O2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">DIVd</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">U_dO2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">V_dO2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dswz</span><span class="o">.</span><span class="n">W_dO2</span><span class="p">,]</span>

<span class="n">cntf</span><span class="o">=</span> <span class="kc">True</span> <span class="p">;</span> <span class="n">cnt</span><span class="o">=</span> <span class="kc">False</span> 
<span class="n">units</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mol.m$^{-3}$.s$^{-1}$&#39;</span><span class="p">]</span>
<span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39;$\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{t}</span><span class="s1">}}$ &#39;</span><span class="p">,</span> 
     <span class="sa">r</span><span class="s2">&quot;$-\overline{U.\nabla</span><span class="si">{O_2}</span><span class="s2">}$&quot;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{U}</span><span class="s1">.\nabla{\overline</span><span class="si">{O_2}</span><span class="s1">}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{u}</span><span class="s1">.\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{x}</span><span class="s1">}}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{v}</span><span class="s1">.\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{y}</span><span class="s1">}}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39;$-\overline</span><span class="si">{w}</span><span class="s1">.\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}}$ &#39;</span><span class="p">,]</span>

<span class="n">clr</span><span class="o">=</span><span class="p">[</span><span class="n">clr_o2</span><span class="p">]</span>
<span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">;</span> <span class="n">alp</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">cb_on</span><span class="o">=</span><span class="kc">True</span>

<span class="n">lo</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3e-9</span><span class="p">;</span> <span class="n">hi</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="p">;</span> <span class="n">hi2</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="p">;</span> <span class="n">dsc</span> <span class="o">=</span> <span class="o">-</span><span class="n">lo</span><span class="o">*</span><span class="mf">0.3e-1</span>
<span class="n">y</span><span class="o">=</span><span class="n">dswz</span><span class="o">.</span><span class="n">month</span>
<span class="n">z</span><span class="o">=</span> <span class="n">dswz</span><span class="o">.</span><span class="n">Z</span><span class="o">*-</span><span class="mi">1</span>

<span class="n">i</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">];</span> <span class="n">j</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">)):</span><span class="c1">#len(VAR))):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">j</span><span class="p">[</span><span class="n">k</span><span class="p">]])</span>
    <span class="n">cs</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">var</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="o">+</span><span class="n">dsc</span><span class="p">,</span> <span class="n">dsc</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span><span class="c1">#, aspect=20)  </span>
    <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.06</span><span class="p">))</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
    <span class="c1"># cs= ax.contour(y,z,dso.transpose()*1e3,colors=&#39;k&#39;,linewidths=lw,alpha=alp)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">();</span> 
    <span class="c1"># ax.set_xlim(coords[1]); </span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span>


<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">cs</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">Uzm</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.01</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span><span class="c1">#, aspect=20)  </span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.06</span><span class="p">))</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">();</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\overline</span><span class="si">{u}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>


<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">cs</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">Vzm</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.001</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span><span class="c1">#, aspect=20)  </span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.06</span><span class="p">))</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">();</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\overline</span><span class="si">{v}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">cs</span><span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="o">-</span><span class="n">Wzm</span><span class="o">.</span><span class="n">Zl</span><span class="p">,</span><span class="o">-</span><span class="n">Wzm</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">4.5e-6</span><span class="p">,</span><span class="mf">4.5e-6</span><span class="p">,</span><span class="mf">0.05e-6</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span><span class="c1">#, aspect=20)  </span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.06</span><span class="p">))</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">();</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Depth (m)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">);</span> 
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\overline</span><span class="si">{w}</span><span class="s1">$&#39;</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 6/6 [00:00&lt;00:00, 13.06it/s]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;$\\overline{w}$&#39;)
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_20_2.png" src="../../../_images/Analysis_O2_Budget_MITgcm_20_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">14</span>
<span class="n">gs2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="c1">#, top=0.3, left=0.38, right=0.95, wspace=0.4, hspace=0.2)    </span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">pc</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="n">do</span><span class="o">.</span><span class="n">TRAC03</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">Linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;O$_2$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">13.</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (months)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;O$_2$ (mol)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;O$_2$ and EKE&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;royalblue&#39;</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;EKE(cm$^2$/s$^2$)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="n">EKE_mn</span><span class="o">*</span><span class="mf">1e4</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">Linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;EKE&#39;</span><span class="p">)</span> 
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="n">VARS</span><span class="o">=</span><span class="p">[</span><span class="n">do</span><span class="o">.</span><span class="n">tend_O2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">do</span><span class="o">.</span><span class="n">adv_h_O2</span><span class="o">-</span><span class="n">do</span><span class="o">.</span><span class="n">adv_v_O2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">do</span><span class="o">.</span><span class="n">DIVd</span><span class="p">,</span>
      <span class="o">-</span><span class="n">do</span><span class="o">.</span><span class="n">DIVdp</span><span class="p">,</span>
      <span class="o">-</span><span class="n">do</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="p">,</span>
      <span class="n">do</span><span class="o">.</span><span class="n">bio_O2</span><span class="p">,]</span>

<span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39; $\overline{\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{t}</span><span class="s1">}}$ &#39;</span><span class="p">,</span> 
     <span class="sa">r</span><span class="s1">&#39; $-\nabla{\overline{(U.O_2)}}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39; $-\nabla{(\overline</span><span class="si">{U}</span><span class="s1">.\overline</span><span class="si">{O_2}</span><span class="s1">)}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s2">&quot; $-\nabla{(\overline{U&#39;.O_2&#39;})}$&quot;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39; $\overline{\frac{\partial</span><span class="si">{}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}k.\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39; $\overline{J(O_2)}$ &#39;</span><span class="p">,]</span>

<span class="n">clr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">]</span><span class="c1">#</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">VAR</span> <span class="ow">in</span> <span class="n">VARS</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">LWW</span><span class="o">=</span><span class="mi">3</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">LWW</span><span class="o">=</span><span class="mf">1.5</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">month</span><span class="p">,</span><span class="n">VAR</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="n">LWW</span><span class="p">)</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;O$_2$ budget&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span><span class="c1"># integrated over &#39;+str(abs(Wi))+&#39;W-&#39;+str(abs(Ei))+&#39;W &#39;+str(top)+&#39;-&#39;+str(bot)+&#39;m&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;O$_2 Tendency (mol.s^{-1})$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Months&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="c1"># ax.set_title(&#39;b) &#39;,fontsize=fs+1,loc=&#39;left&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="c1"># plt.legend(loc=&#39;upper left&#39;,fontsize=fs,frameon=False)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_21_0.png" src="../../../_images/Analysis_O2_Budget_MITgcm_21_0.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plot-interannual-variability-in-budget-terms-and-enso-influence">
<h1>Plot Interannual Variability in Budget Terms and ENSO Influence<a class="headerlink" href="#plot-interannual-variability-in-budget-terms-and-enso-influence" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsbd</span><span class="o">=</span><span class="p">((</span><span class="n">dsb</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">dsbd</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:   (time: 584)
Coordinates:
    iter      (time) int32 105360 105600 105840 106080 ... 245040 245280 245520
  * time      (time) datetime64[ns] 2010-01-04 2010-01-09 ... 2017-12-28
Data variables:
    adv_h_O2  (time) float32 -1.94e+06 -2.179e+06 ... -2.351e+06 -2.856e+06
    adv_v_O2  (time) float32 2.19e+06 2.691e+06 ... 1.457e+06 2.583e+06
    bio_O2    (time) float32 319.8 8.645e+03 2.939e+03 ... -3.476e+04 -3.839e+04
    dif_h_O2  (time) float32 2.984e+03 3.961e+03 ... -3.585e+03 -2.236e+03
    dif_v_O2  (time) float32 -6.899e+05 -7.536e+05 ... -8.389e+05 -9.017e+05
    surf_O2   (time) float32 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0 0.0
    tend_O2   (time) float32 4.374e+05 2.463e+05 ... 1.701e+06 1.139e+06
    adv_huO2  (time) float32 -3.261e+06 -1.431e+06 ... -4.091e+06 -5.342e+06
    adv_vwO2  (time) float32 3.511e+06 1.944e+06 ... 3.197e+06 5.068e+06
    rVOL      (time) float32 3.228e+24 3.228e+24 ... 3.228e+24 3.228e+24</pre><div class='xr-wrap' hidden><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-df7a488e-dfd8-48d9-aafa-9f4485b55c24' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-df7a488e-dfd8-48d9-aafa-9f4485b55c24' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 584</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-20a8e9c1-e544-4bb7-8842-aa163308297c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-20a8e9c1-e544-4bb7-8842-aa163308297c' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>iter</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>105360 105600 ... 245280 245520</div><input id='attrs-feeea271-41d2-4ac5-ae15-341b84b2445e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-feeea271-41d2-4ac5-ae15-341b84b2445e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1392087-d6f9-426f-af2b-454f53fa5848' class='xr-var-data-in' type='checkbox'><label for='data-f1392087-d6f9-426f-af2b-454f53fa5848' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>timestep</dd><dt><span>long_name :</span></dt><dd>model timestep number</dd></dl></div><div class='xr-var-data'><pre>array([105360, 105600, 105840, 106080, 106320, 106560, 106800, 107040,
       107280, 107520, 107760, 108000, 108240, 108480, 108720, 108960,
       109200, 109440, 109680, 109920, 110160, 110400, 110640, 110880,
       111120, 111360, 111600, 111840, 112080, 112320, 112560, 112800,
       113040, 113280, 113520, 113760, 114000, 114240, 114480, 114720,
       114960, 115200, 115440, 115680, 115920, 116160, 116400, 116640,
       116880, 117120, 117360, 117600, 117840, 118080, 118320, 118560,
       118800, 119040, 119280, 119520, 119760, 120000, 120240, 120480,
       120720, 120960, 121200, 121440, 121680, 121920, 122160, 122400,
       122640, 122880, 123120, 123360, 123600, 123840, 124080, 124320,
       124560, 124800, 125040, 125280, 125520, 125760, 126000, 126240,
       126480, 126720, 126960, 127200, 127440, 127680, 127920, 128160,
       128400, 128640, 128880, 129120, 129360, 129600, 129840, 130080,
       130320, 130560, 130800, 131040, 131280, 131520, 131760, 132000,
       132240, 132480, 132720, 132960, 133200, 133440, 133680, 133920,
       134160, 134400, 134640, 134880, 135120, 135360, 135600, 135840,
       136080, 136320, 136560, 136800, 137040, 137280, 137520, 137760,
       138000, 138240, 138480, 138720, 138960, 139200, 139440, 139680,
       139920, 140160, 140400, 140640, 140880, 141120, 141360, 141600,
       141840, 142080, 142320, 142560, 142800, 143040, 143280, 143520,
...
       209280, 209520, 209760, 210000, 210240, 210480, 210720, 210960,
       211200, 211440, 211680, 211920, 212160, 212400, 212640, 212880,
       213120, 213360, 213600, 213840, 214080, 214320, 214560, 214800,
       215040, 215280, 215520, 215760, 216000, 216240, 216480, 216720,
       216960, 217200, 217440, 217680, 217920, 218160, 218400, 218640,
       218880, 219120, 219360, 219600, 219840, 220080, 220320, 220560,
       220800, 221040, 221280, 221520, 221760, 222000, 222240, 222480,
       222720, 222960, 223200, 223440, 223680, 223920, 224160, 224400,
       224640, 224880, 225120, 225360, 225600, 225840, 226080, 226320,
       226560, 226800, 227040, 227280, 227520, 227760, 228000, 228240,
       228480, 228720, 228960, 229200, 229440, 229680, 229920, 230160,
       230400, 230640, 230880, 231120, 231360, 231600, 231840, 232080,
       232320, 232560, 232800, 233040, 233280, 233520, 233760, 234000,
       234240, 234480, 234720, 234960, 235200, 235440, 235680, 235920,
       236160, 236400, 236640, 236880, 237120, 237360, 237600, 237840,
       238080, 238320, 238560, 238800, 239040, 239280, 239520, 239760,
       240000, 240240, 240480, 240720, 240960, 241200, 241440, 241680,
       241920, 242160, 242400, 242640, 242880, 243120, 243360, 243600,
       243840, 244080, 244320, 244560, 244800, 245040, 245280, 245520],
      dtype=int32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2010-01-04 ... 2017-12-28</div><input id='attrs-bdacc8b8-9981-48ad-8e99-f72fdc511fdc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bdacc8b8-9981-48ad-8e99-f72fdc511fdc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-47520ee3-87e8-4377-8460-c6fb7aeb145f' class='xr-var-data-in' type='checkbox'><label for='data-47520ee3-87e8-4377-8460-c6fb7aeb145f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>Time</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2010-01-04T00:00:00.000000000&#x27;, &#x27;2010-01-09T00:00:00.000000000&#x27;,
       &#x27;2010-01-14T00:00:00.000000000&#x27;, ..., &#x27;2017-12-18T00:00:00.000000000&#x27;,
       &#x27;2017-12-23T00:00:00.000000000&#x27;, &#x27;2017-12-28T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-529065da-7fa1-481b-97c7-c371070d2c04' class='xr-section-summary-in' type='checkbox'  checked><label for='section-529065da-7fa1-481b-97c7-c371070d2c04' class='xr-section-summary' >Data variables: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>adv_h_O2</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-1.94e+06 -2.179e+06 ... -2.856e+06</div><input id='attrs-1fdec8e2-a846-494d-b6e5-06e35c9d3fa5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1fdec8e2-a846-494d-b6e5-06e35c9d3fa5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2e53a080-3509-4e4c-9cfa-adf7e8dbe613' class='xr-var-data-in' type='checkbox'><label for='data-2e53a080-3509-4e4c-9cfa-adf7e8dbe613' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-1939763.1  , -2178508.   , -1795024.1  , -1993538.2  ,
       -1534173.4  ,  -880801.1  , -1337426.1  , -1117046.2  ,
        -893627.8  , -1719797.2  , -1200692.4  , -2085389.   ,
       -1864973.6  , -1666028.6  , -1041935.7  , -1211740.6  ,
       -1308307.6  , -1173285.9  , -1004949.56 ,  -885347.   ,
       -1231954.8  ,  -941702.9  , -1514000.2  ,  -766800.4  ,
       -1704777.8  ,  -680405.6  , -1584031.5  ,  -996031.7  ,
       -1240222.6  ,  -780642.1  , -1253238.   , -1380251.1  ,
       -1185423.5  , -1010149.2  , -1497376.4  , -1571842.1  ,
       -1051257.8  , -1627849.9  , -1906861.4  , -1666410.8  ,
       -2800039.5  , -3260427.8  , -3272397.   , -2771955.5  ,
       -3503843.8  , -2228204.2  , -1805224.2  , -1899660.4  ,
       -2149709.   , -2034979.1  , -1542148.2  , -2128208.2  ,
       -1528183.6  , -1019307.8  , -2000415.8  , -1422425.8  ,
       -1398916.   , -1404616.6  , -2654693.2  , -2524083.5  ,
       -2346869.8  , -2078005.2  , -1941648.2  , -1236899.6  ,
       -1984789.1  , -2474319.5  , -2074339.1  , -1865403.   ,
       -2213440.2  , -1759110.6  , -2187503.5  , -2345381.   ,
       -2602676.   , -2445924.8  , -2124747.   , -2164140.2  ,
       -2831657.2  , -1966422.5  , -2273750.   , -2293263.5  ,
...
       -2742607.8  , -2452762.5  , -3068418.8  , -2454113.   ,
       -1966447.1  , -1509723.9  , -2081713.8  , -1965030.5  ,
       -1531124.   , -1560488.6  , -1526938.9  , -1567662.8  ,
       -1344060.4  , -1828910.   , -1717494.2  , -2152933.2  ,
       -1810961.5  , -1583176.2  , -2583837.8  , -1746788.4  ,
       -1620064.2  , -1916197.4  , -1104466.9  , -1863162.6  ,
       -1696558.6  , -1988110.5  , -2318267.   , -1405388.8  ,
       -2879843.8  , -1684915.5  , -1497480.8  , -1677622.5  ,
       -1152068.4  , -1484890.5  , -1131077.1  , -1075339.8  ,
       -1530890.   ,  -978740.9  ,  -977646.8  , -1228682.9  ,
       -1710010.2  , -1096328.1  , -1741770.   ,  -804909.94 ,
       -1801206.5  ,  -992571.3  , -1916276.   ,  -629984.7  ,
       -1739943.   , -1655164.9  , -1252793.8  , -2344711.5  ,
       -1710885.6  , -1924063.2  , -1416325.1  , -1721268.9  ,
       -1228717.   ,  -872422.75 , -1728871.5  , -1825260.1  ,
       -2056250.6  , -1629006.2  , -2524199.2  ,  -814614.9  ,
       -2056965.4  , -2195115.8  , -1760705.9  , -2572098.   ,
       -3380815.   , -2148671.8  , -2179883.8  , -2400643.2  ,
       -2547613.2  , -2103439.8  , -2350615.8  , -2855849.8  ],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>adv_v_O2</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.19e+06 2.691e+06 ... 2.583e+06</div><input id='attrs-a83c5511-800e-4ecf-89d3-aa88446d5f17' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a83c5511-800e-4ecf-89d3-aa88446d5f17' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-763d86eb-4df0-40be-9e71-13efa9bfde04' class='xr-var-data-in' type='checkbox'><label for='data-763d86eb-4df0-40be-9e71-13efa9bfde04' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 2.18960275e+06,  2.69053400e+06,  3.85222750e+06,  6.19949300e+06,
        5.28250500e+06,  6.44427650e+06,  6.30776600e+06,  2.00409850e+06,
        3.93525969e+05,  1.52796450e+06, -6.13901625e+05,  5.22179050e+06,
        5.04149500e+06,  5.46606100e+06,  4.11948025e+06,  4.45478400e+06,
        6.62874600e+06,  4.15030775e+06,  5.38446550e+06,  5.03948100e+06,
        2.45974250e+06,  2.72255400e+06,  2.48220250e+06,  7.92393375e+05,
        1.36817412e+06,  2.74929650e+06,  3.76719950e+06,  2.66455850e+06,
        2.96492100e+06, -3.17629375e+04,  1.76750038e+06,  1.56169950e+06,
        2.54632825e+06,  2.05598662e+06,  1.44124962e+06,  2.32286400e+06,
        4.12606475e+06,  3.22459400e+06,  2.27755975e+06,  1.21563350e+06,
        4.18485000e+06,  4.25044800e+06,  4.22795150e+06,  3.50293275e+06,
        3.05277050e+06,  3.72594350e+06,  3.52280075e+06,  5.00800050e+06,
        4.70192850e+06,  2.17414675e+06,  3.42614675e+06,  2.56878825e+06,
        1.12309000e+06,  1.62326412e+06,  3.58275600e+06,  4.22194050e+06,
        3.81098150e+06,  1.28549925e+06,  4.02514100e+06,  2.63444400e+06,
        2.92527225e+06,  3.17520200e+06,  1.55798712e+06,  1.46819688e+06,
        1.14984462e+06,  2.39972525e+06,  1.24121525e+06,  3.58946250e+06,
        4.13941975e+06,  3.39070950e+06,  4.03575800e+06,  4.97667400e+06,
        6.64817050e+06,  2.62377100e+06,  3.39859000e+06,  5.07378100e+06,
        2.27421250e+06,  3.15895650e+06,  2.17011950e+06,  2.00606650e+06,
...
        2.71689125e+06,  3.06014325e+06,  4.24756300e+06,  2.73268850e+06,
        3.83811775e+06,  2.89053750e+06,  3.97894100e+06,  4.94009500e+06,
        3.09391575e+06,  6.18576700e+06,  6.10054300e+06,  2.99464925e+06,
        4.32759100e+06,  3.22983850e+06,  4.06884200e+06,  4.33845250e+06,
        4.52482900e+06,  3.52851375e+06,  3.59911400e+06,  3.96093375e+06,
        3.74640325e+06,  3.96625400e+06,  2.85910400e+06,  2.47737000e+06,
        1.38254850e+06,  6.76998375e+05,  1.19891475e+06, -8.39866312e+05,
        2.37971750e+05,  1.00078506e+06,  3.13233688e+05,  2.12736825e+06,
        1.07742562e+06,  1.79864062e+06,  1.02163894e+06, -1.91663675e+06,
        5.24944375e+05, -3.06934531e+05,  2.65414688e+04,  9.43358438e+05,
        1.30100125e+06,  2.53119625e+06,  2.05197525e+06,  3.44253700e+06,
        2.46599600e+06,  2.83052600e+06,  4.41690800e+06,  2.07155300e+06,
        1.98010650e+06,  1.27108475e+06,  1.05996088e+06,  3.56803600e+06,
        2.69326875e+06,  2.50628650e+06,  1.83053750e+06,  1.87767975e+06,
        4.49241812e+05,  5.04418312e+05,  3.19384600e+06,  4.00804925e+06,
        4.29951150e+06,  4.51882950e+06,  4.85871250e+06,  1.72314538e+06,
        2.42102975e+06,  1.91796688e+06,  2.33769000e+06,  2.53949325e+06,
        2.66248100e+06,  3.03469450e+06,  3.70727000e+06,  3.48663875e+06,
        4.27200650e+06,  2.88018250e+06,  1.45707762e+06,  2.58270200e+06],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>bio_O2</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>319.8 8.645e+03 ... -3.839e+04</div><input id='attrs-4e8680dc-6a17-4bfe-b2cd-1b223e7c05d8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4e8680dc-6a17-4bfe-b2cd-1b223e7c05d8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb01d470-a7e5-439f-a391-35b65f38e626' class='xr-var-data-in' type='checkbox'><label for='data-eb01d470-a7e5-439f-a391-35b65f38e626' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([    319.76562,    8645.296  ,    2939.338  ,   -3480.502  ,
        -41176.355  ,  -59466.992  , -108748.586  , -128648.85   ,
       -127682.67   , -134265.73   , -117106.01   , -130114.445  ,
       -151896.61   , -182278.25   , -183920.16   , -197802.75   ,
       -212817.34   , -219245.08   , -207639.52   , -202330.47   ,
       -200163.     , -196647.7    , -207124.6    , -232392.25   ,
       -235906.05   , -230117.84   , -247047.88   , -266410.4    ,
       -276674.16   , -286470.88   , -283340.7    , -291842.3    ,
       -289973.28   , -276194.66   , -263272.44   , -248809.39   ,
       -253217.23   , -212338.39   , -210735.06   , -186876.62   ,
       -161599.36   , -154127.42   , -143504.14   , -148324.08   ,
       -146881.66   , -142759.88   , -150284.28   , -142179.72   ,
       -140155.9    , -167649.08   , -159430.36   , -144156.05   ,
       -143248.72   , -131747.78   , -133823.38   , -141198.58   ,
       -161045.06   , -152814.28   , -130736.24   , -126687.94   ,
       -131715.95   , -125256.266  , -119574.96   , -107366.766  ,
        -88563.95   ,  -92489.04   , -103778.19   ,  -95795.09   ,
        -90050.44   ,  -88971.36   ,  -66796.19   ,  -55803.04   ,
        -63488.86   ,  -54960.676  ,  -71137.8    , -100466.15   ,
        -97557.75   ,  -90515.31   ,  -84237.72   ,  -93305.17   ,
...
        -71322.734  ,  -81058.24   ,  -94172.164  ,  -89173.27   ,
        -90919.49   ,  -91482.1    , -111914.29   , -112478.09   ,
       -122087.65   , -104423.95   , -115618.9    , -141212.38   ,
       -158809.56   , -137384.94   , -133549.62   , -123781.664  ,
       -121719.29   , -116521.52   , -115698.21   , -125065.53   ,
       -108315.     , -114170.47   , -116381.84   , -117248.64   ,
       -110896.836  , -118746.53   , -124331.59   , -133100.36   ,
       -145012.98   , -162373.17   , -185328.66   , -200735.6    ,
       -225793.02   , -239446.7    , -255321.75   , -252715.55   ,
       -236569.38   , -242353.73   , -256950.98   , -233311.38   ,
       -219288.83   , -208316.28   , -206595.72   , -198877.77   ,
       -184843.14   , -180728.19   , -172926.53   , -159151.25   ,
       -145466.44   , -127943.58   , -115356.125  , -107980.68   ,
       -102421.016  ,  -91814.44   ,  -84623.39   ,  -78140.77   ,
        -85092.76   ,  -80730.27   ,  -94507.89   , -109721.41   ,
       -130445.34   , -129371.     , -165012.17   , -142575.58   ,
       -124636.19   ,  -94369.39   ,  -86961.51   ,  -69047.29   ,
          3194.8477 ,   -5500.089  ,   30165.258  ,   -1554.5527 ,
         -8040.622  ,  -24987.42   ,  -34762.555  ,  -38390.95   ],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dif_h_O2</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.984e+03 3.961e+03 ... -2.236e+03</div><input id='attrs-72a2a0e3-2448-4e3e-8788-a0b03138db82' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-72a2a0e3-2448-4e3e-8788-a0b03138db82' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-39d01a8e-ff9b-49e7-bfaa-b3bbd2e28259' class='xr-var-data-in' type='checkbox'><label for='data-39d01a8e-ff9b-49e7-bfaa-b3bbd2e28259' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  2984.2415  ,   3961.2205  ,   5869.7285  ,   6291.8115  ,
         5413.629   ,   3829.0957  ,   2783.1182  ,   2682.4265  ,
         2380.4575  ,   2964.7595  ,   2156.8455  ,   2514.183   ,
         2915.3875  ,   2019.4305  ,   2414.4885  ,   2076.6511  ,
         1235.7484  ,   1178.1865  ,   1355.686   ,    597.      ,
          351.7583  ,   -488.16748 ,    -54.264893,    177.01074 ,
          940.9951  ,    845.29663 ,    651.2417  ,    499.4287  ,
         1144.1802  ,   1315.7678  ,   2033.5737  ,   1901.3389  ,
          355.45435 ,   -715.72217 ,  -1271.7227  ,  -2467.3162  ,
        -3373.6182  ,  -4168.3184  ,  -5431.0845  ,  -6972.552   ,
        -8530.462   ,  -9259.746   ,  -9136.732   ,  -9569.778   ,
        -9455.698   ,  -8576.084   ,  -9099.31    ,  -8622.061   ,
        -8307.057   ,  -8657.535   ,  -9509.6     , -10487.357   ,
       -10813.89    , -10451.764   , -11948.101   , -10349.479   ,
       -11209.743   , -12663.98    ,  -7955.9717  ,  -7622.8516  ,
        -8500.195   ,  -9886.717   ,  -9420.719   , -11189.131   ,
       -11160.125   , -10071.38    , -10475.625   ,  -9389.088   ,
       -10513.631   , -10398.618   ,  -7941.969   ,  -7630.9644  ,
        -8727.33    ,  -7210.8486  ,  -5544.0645  ,  -8518.094   ,
        -6085.6104  ,  -6234.007   ,  -6428.6006  ,  -5671.9785  ,
...
        -1873.4558  ,   -483.76404 ,   1741.1097  ,   1410.7212  ,
         2012.7874  ,   -822.01196 ,   -732.92303 ,  -1412.7836  ,
        -1732.0177  ,    309.354   ,   -704.3561  ,  -1337.1082  ,
        -2507.6528  ,  -3745.6458  ,  -4174.9585  ,  -4923.761   ,
        -6108.541   ,  -5904.4194  ,  -4848.4863  ,  -3754.2656  ,
        -3006.4072  ,  -3562.0498  ,  -3905.991   ,  -5559.6484  ,
        -5276.1675  ,  -5311.2266  ,  -5856.3887  ,  -5379.4263  ,
        -5033.175   ,  -3942.9521  ,  -2817.6436  ,  -3683.8198  ,
        -4791.304   ,  -6207.6924  ,  -5657.089   ,  -5185.3545  ,
        -5564.675   ,  -4821.3286  ,  -3898.9229  ,  -3526.3257  ,
        -3730.499   ,  -3778.3447  ,  -5307.7095  ,  -5719.23    ,
        -6685.613   ,  -6336.836   ,  -8457.664   ,  -8033.8247  ,
        -7561.74    ,  -7926.9956  ,  -8556.564   ,  -7828.79    ,
        -7472.2676  ,  -7906.99    ,  -6488.2686  ,  -6413.4478  ,
        -4434.4355  ,  -3435.9238  ,  -4767.9004  ,  -6433.6694  ,
        -7927.6875  ,  -6741.5757  ,  -6816.0605  ,  -6300.669   ,
        -6374.7603  ,  -6373.516   ,  -6457.4043  ,  -4878.549   ,
        -2035.1377  ,  -1996.854   ,  -1432.373   ,  -1726.5139  ,
        -3001.8088  ,  -3007.9492  ,  -3585.3645  ,  -2235.5771  ],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>dif_v_O2</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-6.899e+05 ... -9.017e+05</div><input id='attrs-89506a95-f648-475c-960c-0530803573b8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-89506a95-f648-475c-960c-0530803573b8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-45c57098-908e-47d9-b42c-a5145e08601e' class='xr-var-data-in' type='checkbox'><label for='data-45c57098-908e-47d9-b42c-a5145e08601e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ -689933.4  ,  -753639.7  ,  -767398.4  ,  -584096.9  ,
        -627297.25 ,  -491762.2  ,  -565081.2  ,  -377695.84 ,
        -314943.75 ,  -287513.62 ,  -201655.66 ,  -289811.84 ,
        -332217.75 ,  -252266.31 ,  -200966.53 ,  -191674.66 ,
        -223601.56 ,  -131333.08 ,  -153525.52 ,  -237487.25 ,
        -152423.5  ,  -188365.81 ,  -380974.12 ,  -354886.34 ,
        -459029.97 ,  -794816.6  ,  -629625.5  ,  -691226.06 ,
        -635685.06 ,  -521501.66 ,  -823915.   ,  -889390.75 ,
       -1034569.9  , -1287482.8  , -1030954.4  , -1565691.2  ,
       -1463559.   , -1582365.8  , -1659875.8  , -1170658.   ,
       -1641587.8  , -1549520.4  , -1556873.8  , -1359000.2  ,
       -1342481.9  , -1566739.4  , -1210221.8  , -1805877.   ,
       -1591513.1  , -1185664.8  , -1538895.   , -1210378.4  ,
       -1118336.9  , -1199251.5  , -1277838.   , -1390509.   ,
       -1472191.5  , -1234390.   , -1214562.2  , -1494324.2  ,
       -1685028.9  , -1546815.6  , -1515155.9  , -1623928.2  ,
       -1686984.8  , -1313179.8  , -1099105.   , -1608390.5  ,
       -1685703.1  , -1681348.2  , -1628738.2  , -2033605.2  ,
       -1657881.9  , -1195510.8  ,  -958166.4  , -1236711.8  ,
        -803532.6  ,  -934302.56 ,  -740039.56 ,  -596501.8  ,
...
        -918501.44 ,  -787739.   , -1033851.6  ,  -867521.4  ,
        -723776.94 ,  -523881.44 ,  -518426.84 ,  -605915.1  ,
        -617345.25 ,  -570392.75 ,  -368433.53 ,  -167349.94 ,
        -199925.81 ,  -237063.31 ,  -296670.9  ,  -385158.84 ,
        -261863.98 ,  -337277.56 ,  -300841.06 ,  -260789.67 ,
        -301250.7  ,  -292615.9  ,  -275604.22 ,  -205418.47 ,
        -181662.52 ,  -227801.98 ,  -179172.27 ,  -291595.94 ,
        -239256.17 ,  -441809.88 ,  -500863.03 ,  -546077.6  ,
        -667558.75 ,  -835904.1  ,  -751116.4  ,  -547193.25 ,
        -701575.6  ,  -774955.6  , -1089265.5  ,  -924129.   ,
       -1085376.6  , -1160808.5  , -1481842.6  , -1424146.9  ,
       -1289375.8  , -1506691.1  , -1368975.9  , -1300805.6  ,
       -1337996.2  , -1312238.4  , -1130151.9  , -1750952.4  ,
       -1414212.4  , -1397376.1  , -1942752.1  , -1351790.4  ,
       -1020265.06 ,  -923599.1  , -1052319.8  , -1249491.4  ,
       -1158765.1  , -1143753.   ,  -714909.25 , -1238118.2  ,
       -1336864.6  , -1211001.2  , -1471421.9  , -2099580.5  ,
       -1237657.2  , -1985974.   , -1391944.5  , -1303390.2  ,
       -1761780.   , -1101824.8  ,  -838868.8  ,  -901739.2  ],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>surf_O2</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-d8cd931c-68f1-4275-b627-3ceac98befa1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d8cd931c-68f1-4275-b627-3ceac98befa1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3eec5430-cfb6-4a7a-b58e-0351d3c47a70' class='xr-var-data-in' type='checkbox'><label for='data-3eec5430-cfb6-4a7a-b58e-0351d3c47a70' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0.], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tend_O2</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>4.374e+05 2.463e+05 ... 1.139e+06</div><input id='attrs-f24be5f4-0d5c-43b8-92a9-731dd1a38c66' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f24be5f4-0d5c-43b8-92a9-731dd1a38c66' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-abeb011b-9358-4ab4-ac48-cc240cc4ca98' class='xr-var-data-in' type='checkbox'><label for='data-abeb011b-9358-4ab4-ac48-cc240cc4ca98' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 4.37416969e+05,  2.46279797e+05, -1.29275375e+06, -3.63166350e+06,
       -3.16764125e+06, -5.13503600e+06, -4.51681300e+06, -6.40708500e+05,
        6.84964750e+05,  3.42102344e+05,  1.89697662e+06, -2.97922875e+06,
       -2.99911600e+06, -3.73207150e+06, -3.06291850e+06, -3.25125750e+06,
       -5.31091050e+06, -3.06610750e+06, -4.43497950e+06, -4.11955675e+06,
       -1.27586788e+06, -1.78863688e+06, -7.94289625e+05,  9.67475391e+04,
        5.58801375e+05, -1.50502525e+06, -1.80124462e+06, -1.24418350e+06,
       -1.36679625e+06,  1.04614850e+06,  2.43120156e+04,  4.14237719e+05,
       -6.16625375e+05, -3.38022812e+04,  8.25102750e+05,  5.68355562e+05,
       -8.95805781e+04, -2.22535062e+05,  1.08388250e+06,  1.44152162e+06,
        1.03687219e+05,  4.14617625e+05,  4.66927906e+05,  4.89238875e+05,
        1.65610638e+06, -6.52000430e+04, -6.48552188e+05, -1.43604925e+06,
       -1.09256500e+06,  8.87496188e+05, -4.95034031e+05,  6.36117938e+05,
        1.39098712e+06,  4.73981781e+05, -4.26399500e+05, -1.53986250e+06,
       -1.08970450e+06,  1.21336075e+06, -2.78660375e+05,  1.26489225e+06,
        9.83401250e+05,  3.34237438e+05,  1.78863875e+06,  1.29643812e+06,
        2.44450900e+06,  1.30534488e+06,  1.83891400e+06, -2.02092781e+05,
       -3.19838312e+05, -2.88431133e+04, -2.78391062e+05, -6.45884812e+05,
       -2.44240300e+06,  9.69881688e+05, -3.81296688e+05, -1.76489100e+06,
        1.26948662e+06, -3.42534156e+05,  7.65843688e+05,  7.96050500e+05,
...
        8.74768250e+05,  9.97794688e+04, -2.41213609e+05,  4.98347125e+05,
       -1.24083888e+06, -9.47606688e+05, -1.48998400e+06, -2.48021975e+06,
       -1.06579638e+06, -4.15962675e+06, -4.32009350e+06, -1.39951125e+06,
       -2.93989800e+06, -1.29750325e+06, -2.18404625e+06, -1.91920950e+06,
       -2.56761300e+06, -1.71867362e+06, -8.25277062e+05, -2.07466300e+06,
       -1.93038800e+06, -1.86804012e+06, -1.59149912e+06, -5.20476938e+05,
        3.90053625e+05,  1.42548750e+06,  1.18006362e+06,  2.40914050e+06,
        2.74116975e+06,  9.67528125e+05,  1.50262412e+06, -1.00687523e+05,
        5.21236875e+05,  2.88940875e+05,  6.10936062e+05,  3.29166775e+06,
        1.47656500e+06,  1.82314962e+06,  1.22300088e+06,  9.79719875e+05,
        1.27886962e+06, -4.78560406e+05,  9.70380125e+05, -1.40660800e+06,
        4.46441125e+05, -5.05644000e+05, -1.29610512e+06, -2.91862938e+05,
        9.59937562e+05,  1.57630912e+06,  1.21617712e+06,  4.27471094e+05,
        3.36876500e+05,  7.31228188e+05,  1.45039712e+06,  1.12364400e+06,
        1.71906425e+06,  1.21429862e+06, -5.02404062e+05, -1.03659288e+06,
       -1.20701700e+06, -1.86871050e+06,  6.80759375e+05,  1.93298500e+05,
        8.54535625e+05,  1.40014675e+06,  8.13928875e+05,  2.06800300e+06,
        7.17874312e+05,  1.09642900e+06, -1.03868727e+05,  2.17540594e+05,
        3.23304355e+04,  3.03084125e+05,  1.70121888e+06,  1.13871925e+06],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>adv_huO2</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>-3.261e+06 ... -5.342e+06</div><input id='attrs-a22191b7-3074-45a4-b3b9-fc49b966a436' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a22191b7-3074-45a4-b3b9-fc49b966a436' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80ae195f-f61d-4c82-a4f8-857e401198a0' class='xr-var-data-in' type='checkbox'><label for='data-80ae195f-f61d-4c82-a4f8-857e401198a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-3261258.8  , -1430948.5  ,  1505725.8  ,  2851702.   ,
        2868892.8  ,  1918844.6  ,   608934.3  , -3020481.2  ,
       -3447767.   , -3662193.   , -3395721.   , -1040688.   ,
        2027855.1  ,  2218940.2  ,  1365288.9  ,    58992.797,
        -781378.06 ,  -840870.2  , -1749398.2  , -1173321.2  ,
       -3601101.2  , -3254536.5  , -3239058.2  , -3767725.5  ,
       -3293994.2  , -2819370.2  , -1481078.6  , -2315763.2  ,
       -3202167.5  , -1511436.2  , -1413621.   , -3124645.5  ,
       -2860141.5  , -3888726.8  , -4249723.   , -4465400.   ,
       -1943620.1  , -4399807.5  , -4576951.5  , -3970178.5  ,
       -5365146.   , -5702601.   , -4991114.   , -3815559.2  ,
       -4347668.5  , -2031106.4  , -2292402.5  , -2234261.5  ,
       -3088726.   , -4093456.   , -2601089.8  , -3398161.5  ,
       -4571087.   , -2557604.2  , -2190429.5  , -2713029.8  ,
       -1853542.8  , -3971717.5  , -3812386.2  , -2920003.   ,
       -3027948.   , -4271790.5  , -4335504.5  , -4254883.5  ,
       -6518988.5  , -4826941.5  , -4292089.   , -1782081.8  ,
       -2093162.4  , -4198008.   , -3325250.8  , -3070909.2  ,
       -2485053.5  , -2683754.5  , -2451189.   , -3104360.   ,
       -3962091.8  , -4989868.5  , -4204892.   , -3527562.2  ,
...
       -4758977.5  , -3531924.   , -2954815.   , -3477053.2  ,
       -1828094.5  ,  -452028.62 , -2896800.   , -2071309.   ,
       -1457854.1  , -1734571.8  , -1189937.   , -1235128.   ,
       -1695717.5  , -1751500.1  , -2788946.8  , -2831632.5  ,
       -3147760.2  , -3026977.   , -1873977.9  , -2771332.2  ,
       -1942349.   , -2390878.8  , -2586417.8  , -3455191.   ,
       -4799431.5  , -4122736.5  , -4290863.5  , -5023343.5  ,
       -4389593.5  , -4959583.   , -4315186.5  , -3739936.   ,
       -3536583.2  , -3430238.2  , -3682148.5  , -3638963.5  ,
       -4373431.5  , -5734582.5  , -5592351.5  , -4072164.   ,
       -3468826.8  , -2612974.5  , -1873775.4  ,  -785751.25 ,
       -2238587.   , -1371310.8  ,  -402215.34 , -1862709.6  ,
       -3812706.5  , -3362688.   , -3335760.8  , -3557504.5  ,
       -2799194.2  , -2616496.   , -2054379.1  , -3232229.8  ,
       -2586921.5  , -1846993.9  , -2441739.   , -1616476.2  ,
       -2143913.8  , -2101012.   ,  -862010.4  , -3383597.5  ,
       -3836209.   , -5193465.5  , -2330214.2  , -3608415.2  ,
       -2979725.   , -3352465.   , -2373480.8  , -2180873.2  ,
       -2771447.8  , -2927477.5  , -4090753.5  , -5341619.   ],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>adv_vwO2</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>3.511e+06 1.944e+06 ... 5.068e+06</div><input id='attrs-8953534c-42bf-4635-ae1c-82650a2147ae' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8953534c-42bf-4635-ae1c-82650a2147ae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae052cd6-f66c-4de1-bf53-4d55c39c0e20' class='xr-var-data-in' type='checkbox'><label for='data-ae052cd6-f66c-4de1-bf53-4d55c39c0e20' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 3.5113860e+06,  1.9435060e+06,  5.5223238e+05,  1.3554246e+06,
        8.7995738e+05,  3.6454680e+06,  4.3615395e+06,  3.9070892e+06,
        2.9471958e+06,  3.4701678e+06,  1.5804550e+06,  4.1777665e+06,
        1.1492561e+06,  1.5820690e+06,  1.7128644e+06,  3.1843808e+06,
        6.1025165e+06,  3.8181948e+06,  6.1290755e+06,  5.3275570e+06,
        4.8287245e+06,  5.0355185e+06,  4.2075005e+06,  3.7934052e+06,
        2.9574342e+06,  4.8886825e+06,  3.6649285e+06,  3.9847778e+06,
        4.9269775e+06,  6.9923850e+05,  1.9281439e+06,  3.3060305e+06,
        4.2212635e+06,  4.9344540e+06,  4.1938178e+06,  5.2165490e+06,
        5.0189695e+06,  5.9967370e+06,  4.9478525e+06,  3.5197275e+06,
        6.7500285e+06,  6.6929765e+06,  5.9469625e+06,  4.5463100e+06,
        3.8968338e+06,  3.5292488e+06,  4.0102188e+06,  5.3429305e+06,
        5.6411415e+06,  4.2326660e+06,  4.4852630e+06,  3.8390502e+06,
        4.1656878e+06,  3.1618525e+06,  3.7729242e+06,  5.5131055e+06,
        4.2657455e+06,  3.8525772e+06,  5.1827370e+06,  3.0306458e+06,
        3.6062292e+06,  5.3689370e+06,  3.9516620e+06,  4.4860330e+06,
        5.6840135e+06,  4.7523830e+06,  3.4588025e+06,  3.5065788e+06,
        4.0195890e+06,  5.8294010e+06,  5.1735465e+06,  5.7028075e+06,
        6.5305760e+06,  2.8617130e+06,  3.7251302e+06,  6.0136660e+06,
        3.4046860e+06,  6.1823145e+06,  4.1011582e+06,  3.2404348e+06,
...
        4.7328145e+06,  4.1398800e+06,  4.1338528e+06,  3.7555580e+06,
        3.6998485e+06,  1.8332700e+06,  4.7943770e+06,  5.0467485e+06,
        3.0204748e+06,  6.3597985e+06,  5.7638380e+06,  2.6622902e+06,
        4.6796110e+06,  3.1524770e+06,  5.1404160e+06,  5.0173100e+06,
        5.8619650e+06,  4.9724825e+06,  2.8894075e+06,  4.9859170e+06,
        4.0686838e+06,  4.4410990e+06,  4.3411480e+06,  4.0694675e+06,
        4.4849845e+06,  2.8115042e+06,  3.1712375e+06,  2.7777515e+06,
        1.7476652e+06,  4.2756970e+06,  3.1308890e+06,  4.1897812e+06,
        3.4620048e+06,  3.7439580e+06,  3.5726735e+06,  6.4663525e+05,
        3.3671708e+06,  4.4484475e+06,  4.6407900e+06,  3.7869878e+06,
        3.0596915e+06,  4.0479430e+06,  2.1843590e+06,  3.4235670e+06,
        2.9031415e+06,  3.2097655e+06,  2.9031240e+06,  3.3042865e+06,
        4.0528065e+06,  2.9787042e+06,  3.1425695e+06,  4.7810880e+06,
        3.7818472e+06,  3.1989640e+06,  2.4686922e+06,  3.3887875e+06,
        1.8074460e+06,  1.4789790e+06,  3.9068592e+06,  3.7997718e+06,
        4.3869315e+06,  4.9909565e+06,  3.1964978e+06,  4.2920555e+06,
        4.2004030e+06,  4.9161100e+06,  2.9072725e+06,  3.5759582e+06,
        2.2613045e+06,  4.2383765e+06,  3.9007920e+06,  3.2668708e+06,
        4.4960155e+06,  3.7038085e+06,  3.1969930e+06,  5.0683050e+06],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rVOL</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>3.228e+24 3.228e+24 ... 3.228e+24</div><input id='attrs-324bc2d1-2a10-4346-9fe7-6d9895103fc7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-324bc2d1-2a10-4346-9fe7-6d9895103fc7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20128731-dc23-42ae-b755-0ccd2b9d5d3b' class='xr-var-data-in' type='checkbox'><label for='data-20128731-dc23-42ae-b755-0ccd2b9d5d3b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
...
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24,
       3.2283477e+24, 3.2283477e+24, 3.2283477e+24, 3.2283477e+24],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d4c2daea-7172-4cc6-8de7-71c4b9eb9ad1' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d4c2daea-7172-4cc6-8de7-71c4b9eb9ad1' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Nn</span><span class="o">=</span><span class="mi">5</span>
<span class="n">Sn</span><span class="o">=-</span><span class="mi">5</span>
<span class="n">Wn</span><span class="o">=</span><span class="mi">170</span>
<span class="n">En</span><span class="o">=</span><span class="mi">120</span>
<span class="n">nino34</span><span class="o">=</span><span class="p">(((</span><span class="n">dsv</span><span class="p">[</span><span class="s1">&#39;THETA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rA</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">Wn</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">En</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Sn</span><span class="p">,</span><span class="n">Nn</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">}))</span><span class="o">/</span><span class="p">(</span><span class="n">dsw</span><span class="o">.</span><span class="n">rA</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">Wn</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">En</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Sn</span><span class="p">,</span><span class="n">Nn</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">})))</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rm</span><span class="o">=</span><span class="mi">6</span><span class="o">*</span><span class="mi">5</span>
<span class="n">anomaly</span><span class="p">(</span><span class="n">nino34</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">rm</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Niño3.4&#39;</span><span class="p">)</span>
<span class="n">anomaly</span><span class="p">(</span><span class="n">nino34</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Niño3.4 Index&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Niño3.4 (ºC)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="s1">&#39;2010-02&#39;</span><span class="p">,</span><span class="s1">&#39;2017-10&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="p">(</span><span class="n">EKE_m</span><span class="o">*</span><span class="mf">1e4</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">rm</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;EKE&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">EKE_m</span><span class="o">*</span><span class="mf">1e4</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Eddy Kinetic Energy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;EKE (cm2/s2)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="s1">&#39;2010-02&#39;</span><span class="p">,</span><span class="s1">&#39;2017-10&#39;</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">O2_rho</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="n">O2_rho</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">rm</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;O2&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">O2_rho</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="n">O2_rho</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;O2 integrated over $\sigma$ &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rho_u</span><span class="o">-</span><span class="mf">1e3</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rho_d</span><span class="o">-</span><span class="mf">1e3</span><span class="p">)[:</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;O2 (mol)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="s1">&#39;2010-02&#39;</span><span class="p">,</span><span class="s1">&#39;2017-10&#39;</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">O2_rho</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="o">-</span><span class="n">dsbd</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">rm</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;vert mix O2&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">O2_rho</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="o">-</span><span class="n">dsbd</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Vertical Mixing of O2 integrated over 50-150m depth&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;tendency O2 (mol/s)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="s1">&#39;2010-02&#39;</span><span class="p">,</span><span class="s1">&#39;2017-10&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(14641.0, 17440.0)
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_25_1.png" src="../../../_images/Analysis_O2_Budget_MITgcm_25_1.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_25_2.png" src="../../../_images/Analysis_O2_Budget_MITgcm_25_2.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_25_3.png" src="../../../_images/Analysis_O2_Budget_MITgcm_25_3.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_25_4.png" src="../../../_images/Analysis_O2_Budget_MITgcm_25_4.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">14</span>

<span class="n">rm</span><span class="o">=</span><span class="mi">6</span><span class="o">*</span><span class="mi">5</span>

<span class="n">gs2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="c1">#, top=0.3, left=0.38, right=0.95, wspace=0.4, hspace=0.2)    </span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">anomaly</span><span class="p">(</span><span class="n">nino34</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">rm</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Niño3.4 &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rm</span><span class="o">/</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-mon run mean&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">anomaly</span><span class="p">(</span><span class="n">nino34</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Niño3.4 Index&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Niño3.4 (ºC)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="s1">&#39;2010-02&#39;</span><span class="p">,</span><span class="s1">&#39;2017-10&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># (anomaly(EKE_m)*1e4).rolling(time=rm,center=True).mean().plot(color=&#39;blue&#39;,lw=2,label=&#39;EKE &#39;+str(rm/6)[0]+&#39;-mon run mean&#39;)</span>
<span class="c1"># (anomaly(EKE_m)*1e4).plot(color=&#39;grey&#39;,lw=0.5)</span>
<span class="p">((</span><span class="n">EKE_m</span><span class="p">)</span><span class="o">*</span><span class="mf">1e4</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">rm</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;EKE &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">rm</span><span class="o">/</span><span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-mon run mean&#39;</span><span class="p">)</span>
<span class="p">((</span><span class="n">EKE_m</span><span class="p">)</span><span class="o">*</span><span class="mf">1e4</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Eddy Kinetic Energy&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;EKE (cm2/s2)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="s1">&#39;2010-02&#39;</span><span class="p">,</span><span class="s1">&#39;2017-10&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="c1"># ax = fig.add_subplot(gs2[2,0])</span>
<span class="c1"># plt.plot(O2_rho.time,O2_rho.rolling(time=rm,center=True).mean(),lw=2,label=&#39;O2&#39;,color=&#39;black&#39;)</span>
<span class="c1"># plt.plot(O2_rho.time,O2_rho,lw=0.5,color=&#39;grey&#39;)</span>
<span class="c1"># plt.legend()</span>
<span class="c1"># plt.title(&#39;O2 integrated over $\sigma$ &#39;+str(rho_u-1e3)[:4]+&#39;-&#39;+str(rho_d-1e3)[:3],fontsize=14)</span>
<span class="c1"># plt.ylabel(&#39;O2 (mol)&#39;,fontsize=14)</span>
<span class="c1"># plt.xlabel(&#39;Time&#39;,fontsize=14)</span>
<span class="c1"># plt.xlim([&#39;2010-02&#39;,&#39;2017-10&#39;])</span>
<span class="c1"># plt.tick_params(axis=&#39;both&#39;, which=&#39;major&#39;, labelsize=fs)</span>

<span class="c1"># ax = fig.add_subplot(gs2[2,0])</span>
<span class="c1"># plt.plot(O2_rho.time,-dsbd.dif_v_O2.rolling(time=rm,center=True).mean(),lw=2,</span>
<span class="c1">#          label=&#39;vert mix O2&#39;,color=&#39;orange&#39;)</span>
<span class="c1"># plt.plot(O2_rho.time,-dsbd.dif_v_O2,lw=0.5,color=&#39;grey&#39;)</span>
<span class="c1"># plt.legend()</span>
<span class="c1"># plt.title(&#39;Vertical Mixing of O2 integrated over 50-150m depth&#39;,fontsize=14)</span>
<span class="c1"># plt.ylabel(&#39;tendency O2 (mol/s)&#39;,fontsize=14)</span>
<span class="c1"># plt.xlabel(&#39;Time&#39;,fontsize=14)</span>
<span class="c1"># plt.xlim([&#39;2010-02&#39;,&#39;2017-10&#39;])</span>
<span class="c1"># plt.tick_params(axis=&#39;both&#39;, which=&#39;major&#39;, labelsize=fs)</span>


<span class="n">VARS</span><span class="o">=</span><span class="p">[</span><span class="n">dsbd</span><span class="o">.</span><span class="n">tend_O2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dsbd</span><span class="o">.</span><span class="n">adv_h_O2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dsbd</span><span class="o">.</span><span class="n">adv_v_O2</span><span class="p">,</span>
      <span class="o">-</span><span class="n">dsbd</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="p">,</span>
      <span class="n">dsbd</span><span class="o">.</span><span class="n">bio_O2</span><span class="p">,</span>
     <span class="p">]</span>

<span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s1">&#39; $\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{t}</span><span class="s1">}$ &#39;</span><span class="p">,</span> 
     <span class="sa">r</span><span class="s1">&#39; $-U.\nabla_h</span><span class="si">{O_2}</span><span class="s1">$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39; $-W.\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39; $\frac{\partial</span><span class="si">{}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}k.\frac{\partial</span><span class="si">{O_2}</span><span class="s1">}{\partial</span><span class="si">{z}</span><span class="s1">}$ &#39;</span><span class="p">,</span>
     <span class="sa">r</span><span class="s1">&#39; $J(O_2)$ &#39;</span><span class="p">,</span>
      <span class="p">]</span>

<span class="n">clr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span>
     <span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span>
     <span class="s1">&#39;green&#39;</span><span class="p">,</span>
     <span class="s1">&#39;orange&#39;</span><span class="p">,</span>
     <span class="s1">&#39;lightgreen&#39;</span><span class="p">,</span>
    <span class="p">]</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">VAR</span> <span class="ow">in</span> <span class="n">VARS</span><span class="p">[:]:</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span> <span class="n">LWW</span><span class="o">=</span><span class="mf">2.0</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span> <span class="n">LWW</span><span class="o">=</span><span class="mf">1.2</span>
    <span class="c1"># ax.plot(dsv.time,anomaly(VAR).rolling(time=rm,center=True).mean(),label=str(title[i]), color=clr[i],lw=LWW)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">time</span><span class="p">,(</span><span class="n">VAR</span><span class="p">)</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">rm</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="n">label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">title</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="n">clr</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="n">LWW</span><span class="p">)</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;O$_2$ budget&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span><span class="c1"># integrated over &#39;+str(abs(Wi))+&#39;W-&#39;+str(abs(Ei))+&#39;W &#39;+str(top)+&#39;-&#39;+str(bot)+&#39;m&#39;)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;O$_2 Tendency (mol.s^{-1})$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="c1"># ax.set_title(&#39;b) &#39;,fontsize=fs+1,loc=&#39;left&#39;)</span>
<span class="c1"># plt.legend(loc=&#39;upper left&#39;,fontsize=fs,frameon=True)</span>
<span class="c1"># plt.ylim(-5e6,3.0e6)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="s1">&#39;2010-02&#39;</span><span class="p">,</span><span class="s1">&#39;2017-10&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_26_0.png" src="../../../_images/Analysis_O2_Budget_MITgcm_26_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">14</span><span class="p">;</span> <span class="n">fsx</span><span class="o">=</span><span class="mi">8</span>
<span class="n">EE</span><span class="o">=-</span><span class="mf">200.0</span><span class="p">;</span> <span class="n">WW</span><span class="o">=-</span><span class="mf">70.1</span><span class="p">;</span> <span class="n">SS</span><span class="o">=-</span><span class="mf">17.0</span><span class="p">;</span> <span class="n">NN</span><span class="o">=</span><span class="mf">17.1</span>
<span class="n">coor</span><span class="o">=</span><span class="p">[</span><span class="n">EE</span><span class="p">,</span><span class="n">WW</span><span class="p">,</span><span class="n">SS</span><span class="p">,</span><span class="n">NN</span><span class="p">];</span> <span class="n">CL</span><span class="o">=</span><span class="mf">215.0</span> <span class="c1"># central longtiude </span>
<span class="n">lon_lab</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">EE</span><span class="p">,</span><span class="n">WW</span><span class="p">,</span><span class="mi">20</span><span class="p">)])</span>
<span class="n">lat_lab</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">SS</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="n">VAR</span><span class="o">=</span> <span class="p">[</span>
    <span class="n">anomaly</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">THETA</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
    <span class="n">EKE</span><span class="o">*</span><span class="mf">1e4</span><span class="p">,</span>
    <span class="c1"># ((dsv.TRAC03*1e3*dsw.rVOL).sel(Z=slice(Du,Dl)).sum(&#39;Z&#39;))/(dsw.rVOL.sel(Z=slice(Du,Dl)).sum(&#39;Z&#39;)),</span>
    <span class="n">dso</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">PD</span><span class="o">=</span><span class="mf">1026.0</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span>
    <span class="p">]</span>

<span class="n">units</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$^</span><span class="si">{o}</span><span class="s1">$C&#39;</span><span class="p">,</span>
      <span class="s1">&#39;cm$^{-2}$.s$^{-2}$&#39;</span><span class="p">,</span>
      <span class="s1">&#39;mmol.m$^{-3}$&#39;</span><span class="p">,</span>
      <span class="s1">&#39;mmol.m$^{-3}$&#39;</span><span class="p">,]</span>
<span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\overline</span><span class="si">{EKE}</span><span class="s1">$ &#39;</span><span class="p">,</span><span class="s1">&#39;O2 50-150m&#39;</span><span class="p">,</span><span class="s1">&#39;O2 on 24.5&#39;</span><span class="p">]</span>
<span class="n">clrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cmo.balance&#39;</span><span class="p">,</span><span class="s1">&#39;glacial&#39;</span><span class="p">,</span><span class="s1">&#39;acton&#39;</span><span class="p">,</span><span class="s1">&#39;acton&#39;</span><span class="p">]</span>
<span class="n">lmax</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mf">10e2</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>
<span class="n">lmin</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">lstp</span><span class="o">=</span><span class="p">[</span><span class="mf">3e-2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">200e-2</span><span class="p">,</span><span class="mf">200e-2</span><span class="p">]</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">rng</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">t1</span><span class="o">=</span><span class="s1">&#39;2010-10&#39;</span>
<span class="n">t2</span><span class="o">=</span><span class="s1">&#39;2011-02&#39;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)):</span><span class="c1">#len(VAR))):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_cmap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">XC</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">YC</span><span class="p">,</span> <span class="n">VAR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">),</span><span class="n">lmin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lmax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lstp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                   <span class="n">clrs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">title</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">coor</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">fsx</span><span class="p">,</span> <span class="n">lon_lab</span><span class="p">,</span><span class="n">lat_lab</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">VAR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,)</span>

<span class="n">t1</span><span class="o">=</span><span class="s1">&#39;2015-10&#39;</span>
<span class="n">t2</span><span class="o">=</span><span class="s1">&#39;2016-02&#39;</span>
<span class="n">rng</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)):</span><span class="c1">#len(VAR))):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_cmap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">XC</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">YC</span><span class="p">,</span> <span class="n">VAR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">),</span><span class="n">lmin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lmax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lstp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                   <span class="n">clrs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">title</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">coor</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">fsx</span><span class="p">,</span> <span class="n">lon_lab</span><span class="p">,</span><span class="n">lat_lab</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">VAR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,)</span>
            
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 3/3 [00:53&lt;00:00, 17.92s/it]
100%|██████████| 3/3 [01:12&lt;00:00, 24.11s/it]
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_27_1.png" src="../../../_images/Analysis_O2_Budget_MITgcm_27_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">14</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">14</span><span class="p">;</span> <span class="n">fsx</span><span class="o">=</span><span class="mi">8</span>
<span class="n">EE</span><span class="o">=-</span><span class="mf">200.0</span><span class="p">;</span> <span class="n">WW</span><span class="o">=-</span><span class="mf">70.1</span><span class="p">;</span> <span class="n">SS</span><span class="o">=-</span><span class="mf">17.0</span><span class="p">;</span> <span class="n">NN</span><span class="o">=</span><span class="mf">17.1</span>
<span class="n">coor</span><span class="o">=</span><span class="p">[</span><span class="n">EE</span><span class="p">,</span><span class="n">WW</span><span class="p">,</span><span class="n">SS</span><span class="p">,</span><span class="n">NN</span><span class="p">];</span> <span class="n">CL</span><span class="o">=</span><span class="mf">215.0</span> <span class="c1"># central longtiude </span>
<span class="n">lon_lab</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">EE</span><span class="p">,</span><span class="n">WW</span><span class="p">,</span><span class="mi">20</span><span class="p">)])</span>
<span class="n">lat_lab</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">SS</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>

<span class="n">VAR</span><span class="o">=</span> <span class="p">[</span>
    <span class="n">anomaly</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">THETA</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">)),</span>
    <span class="n">EKE</span><span class="o">*</span><span class="mf">1e4</span><span class="p">,</span>
    <span class="c1"># ((dsv.TRAC03*1e3*dsw.rVOL).sel(Z=slice(Du,Dl)).sum(&#39;Z&#39;))/(dsw.rVOL.sel(Z=slice(Du,Dl)).sum(&#39;Z&#39;)),</span>
    <span class="n">dso</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">PD</span><span class="o">=</span><span class="mf">1026.0</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">,</span>
    <span class="p">]</span>

<span class="n">units</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;$^</span><span class="si">{o}</span><span class="s1">$C&#39;</span><span class="p">,</span>
      <span class="s1">&#39;cm$^{-2}$.s$^{-2}$&#39;</span><span class="p">,</span>
      <span class="s1">&#39;mmol.m$^{-3}$&#39;</span><span class="p">,</span>
      <span class="s1">&#39;mmol.m$^{-3}$&#39;</span><span class="p">,]</span>
<span class="n">title</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;SST&#39;</span><span class="p">,</span><span class="sa">r</span><span class="s1">&#39;$\overline</span><span class="si">{EKE}</span><span class="s1">$ &#39;</span><span class="p">,</span><span class="s1">&#39;O2 50-150m&#39;</span><span class="p">,</span><span class="s1">&#39;O2 on 24.5&#39;</span><span class="p">]</span>
<span class="n">clrs</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;cmo.balance&#39;</span><span class="p">,</span><span class="s1">&#39;glacial&#39;</span><span class="p">,</span><span class="s1">&#39;acton&#39;</span><span class="p">,</span><span class="s1">&#39;acton&#39;</span><span class="p">]</span>
<span class="n">lmax</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mf">10e2</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">]</span>
<span class="n">lmin</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">lstp</span><span class="o">=</span><span class="p">[</span><span class="mf">3e-2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mf">200e-2</span><span class="p">,</span><span class="mf">200e-2</span><span class="p">]</span>

<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">rng</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">t1</span><span class="o">=</span><span class="s1">&#39;2010-10&#39;</span>
<span class="n">t2</span><span class="o">=</span><span class="s1">&#39;2011-02&#39;</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)):</span><span class="c1">#len(VAR))):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_cmap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">XC</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">YC</span><span class="p">,</span> <span class="n">VAR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">),</span><span class="n">lmin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lmax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lstp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                   <span class="n">clrs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">title</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">coor</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">fsx</span><span class="p">,</span> <span class="n">lon_lab</span><span class="p">,</span><span class="n">lat_lab</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">VAR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,)</span>

<span class="n">t1</span><span class="o">=</span><span class="s1">&#39;2015-10&#39;</span>
<span class="n">t2</span><span class="o">=</span><span class="s1">&#39;2016-02&#39;</span>
<span class="n">rng</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">r</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="n">c</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)):</span><span class="c1">#len(VAR))):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plot_cmap</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">XC</span><span class="p">,</span><span class="n">dsw</span><span class="o">.</span><span class="n">YC</span><span class="p">,</span> <span class="n">VAR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">),</span><span class="n">lmin</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lmax</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lstp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                   <span class="n">clrs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">title</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">coor</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">fsx</span><span class="p">,</span> <span class="n">lon_lab</span><span class="p">,</span><span class="n">lat_lab</span><span class="p">)</span>    
    <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">VAR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,)</span>
            
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 3/3 [01:13&lt;00:00, 24.46s/it]
100%|██████████| 3/3 [01:02&lt;00:00, 20.68s/it]
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_28_1.png" src="../../../_images/Analysis_O2_Budget_MITgcm_28_1.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="dynamics-of-o2-mixing-and-air-sea-flux">
<h1>Dynamics of O2 mixing and air-sea flux<a class="headerlink" href="#dynamics-of-o2-mixing-and-air-sea-flux" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsl</span><span class="o">=</span><span class="n">dsv</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">dsl</span>
<span class="n">dsbl</span><span class="o">=</span><span class="n">dsb</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
<span class="n">dsbl</span>

<span class="n">dsol</span><span class="o">=</span><span class="n">dso</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">73</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="o">=</span><span class="mi">1026</span>
<span class="n">land_50m</span> <span class="o">=</span> <span class="n">cft</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="s1">&#39;land&#39;</span><span class="p">,</span> <span class="s1">&#39;50m&#39;</span><span class="p">,</span>
                                   <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Mercator</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=-</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">min_latitude</span><span class="o">=-</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">max_latitude</span><span class="o">=</span><span class="mf">15.0</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">fsx</span><span class="o">=</span><span class="mi">12</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">16</span>
<span class="n">zz</span><span class="o">=</span><span class="mi">13</span>
<span class="n">EE</span><span class="o">=-</span><span class="mf">200.0</span><span class="p">;</span> <span class="n">WW</span><span class="o">=-</span><span class="mf">70.1</span><span class="p">;</span> <span class="n">SS</span><span class="o">=-</span><span class="mf">17.0</span><span class="p">;</span> <span class="n">NN</span><span class="o">=</span><span class="mf">17.1</span>
<span class="n">lon_lab</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">EE</span><span class="p">,</span><span class="n">WW</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
<span class="n">lat_lab</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">SS</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NN</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="n">Wq</span><span class="o">=</span><span class="mi">160</span><span class="p">;</span> <span class="n">Eq</span><span class="o">=</span><span class="mi">100</span><span class="p">;</span> <span class="n">Sq</span><span class="o">=-</span><span class="mi">5</span><span class="p">;</span> <span class="n">Nq</span><span class="o">=</span><span class="mi">10</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="n">Wq</span><span class="p">,</span> <span class="o">-</span><span class="n">Eq</span><span class="p">,</span> <span class="n">Sq</span><span class="p">,</span> <span class="n">Nq</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">land_50m</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
    <span class="n">p1</span><span class="o">=</span><span class="n">dsv</span><span class="o">.</span><span class="n">THETA</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">time</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cmo.balance&#39;</span><span class="p">,</span><span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.05</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;SST (ºC)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;SST on &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dso</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">36</span><span class="p">:</span><span class="mi">46</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;latitude (N)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;longitude (E)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">fsx</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">};</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">fsx</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">};</span> 
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylabels_right</span><span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">xlines</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylines</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lon_lab</span><span class="p">);</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lat_lab</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span> <span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>

<span class="c1">#     ax = fig.add_subplot(gs[1, 0],projection=projection)</span>
<span class="c1">#     ax.set_extent([-Wq, -Eq, Sq, Nq], crs=ccrs.PlateCarree())</span>
<span class="c1">#     ax.add_feature(land_50m)</span>
<span class="c1">#     ax.coastlines(resolution=&#39;50m&#39;)</span>
<span class="c1">#     # p1=(dso.TRAC03.sel(PD=rho).isel(time=i)*1e3).plot(cmap=&#39;acton&#39;,add_colorbar=False,levels=np.arange(0,220,5), transform=ccrs.PlateCarree())</span>
<span class="c1">#     # dsv.THETA.isel(Z=0,time=i).plot.contour(x=&#39;XC&#39;, y=&#39;YC&#39;,levels=np.arange(24,28,0.5), colors=&#39;black&#39;, linewidths=0.1, transform=ccrs.PlateCarree())</span>
<span class="c1">#     # (dso.TRAC03.sel(PD=rho).isel(time=i)*1e3).plot.contour(x=&#39;XC&#39;, y=&#39;YC&#39;,vmin=60, vmax=60.1, colors=&#39;cyan&#39;, linewidths=0.6, transform=ccrs.PlateCarree())</span>
<span class="c1">#     p1=(dsv.TRAC03.isel(Z=zz).isel(time=i)*1e3).plot(cmap=&#39;acton&#39;,add_colorbar=False,levels=np.arange(0,220,5), transform=ccrs.PlateCarree())</span>
<span class="c1">#     # (dsv.TRAC03.isel(Z=zz).isel(time=i)*1e3).plot.contour(x=&#39;XC&#39;, y=&#39;YC&#39;,vmin=60, vmax=60.1, colors=&#39;lime&#39;, linewidths=0.5, transform=ccrs.PlateCarree())</span>
<span class="c1">#     cbar = plt.colorbar(p1)</span>
<span class="c1">#     cbar.set_label(&#39;O$_2$ (mmol.m$^{-3}$)&#39;,fontsize=fs);</span>
<span class="c1">#     plt.title(&quot;O$_2$ on $\sigma$=&quot;+str((rho-1e3))[:4]+&quot; on &quot;+ str(dso.time[i])[36:46],fontsize=fs)</span>
<span class="c1">#     plt.title(&quot;O$_2$ on Z=&quot;+str((dsv.Z[zz].values))[1:4]+&quot;m on &quot;+ str(dso.time[i])[36:46],fontsize=fs)</span>
<span class="c1">#     plt.ylabel(&#39;latitude (N)&#39;)</span>
<span class="c1">#     plt.xlabel(&#39;longitude (E)&#39;)</span>
<span class="c1">#     gl=ax.gridlines(draw_labels=True)</span>
<span class="c1">#     gl.xlabel_style = {&#39;size&#39;: fsx, &#39;color&#39;: &#39;black&#39;}; gl.ylabel_style = {&#39;size&#39;: fsx, &#39;color&#39;: &#39;black&#39;}; </span>
<span class="c1">#     gl.xlabels_top = False; gl.ylabels_right= False; gl.xlines = False; gl.ylines = False</span>
<span class="c1">#     gl.xlocator = mticker.FixedLocator(lon_lab); gl.ylocator = mticker.FixedLocator(lat_lab)</span>
<span class="c1">#     gl.xformatter = LONGITUDE_FORMATTER ; gl.yformatter = LATITUDE_FORMATTER</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="n">Wq</span><span class="p">,</span> <span class="o">-</span><span class="n">Eq</span><span class="p">,</span> <span class="n">Sq</span><span class="p">,</span> <span class="n">Nq</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">land_50m</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
    <span class="c1"># p1=(dso.TRAC03.sel(PD=rho).isel(time=i)*1e3).plot(cmap=&#39;acton&#39;,add_colorbar=False,levels=np.arange(0,220,5), transform=ccrs.PlateCarree())</span>
    <span class="c1"># dsv.THETA.isel(Z=0,time=i).plot.contour(x=&#39;XC&#39;, y=&#39;YC&#39;,levels=np.arange(24,28,0.5), colors=&#39;black&#39;, linewidths=0.1, transform=ccrs.PlateCarree())</span>
    <span class="c1"># (dso.TRAC03.sel(PD=rho).isel(time=i)*1e3).plot.contour(x=&#39;XC&#39;, y=&#39;YC&#39;,vmin=60, vmax=60.1, colors=&#39;cyan&#39;, linewidths=0.6, transform=ccrs.PlateCarree())</span>
    <span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="n">dsb</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="o">-</span><span class="mi">150</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cmo.balance&#39;</span><span class="p">,</span><span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2e-8</span><span class="p">,</span><span class="mf">2e-8</span><span class="p">,</span><span class="mf">0.01e-8</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">dsv</span><span class="o">.</span><span class="n">THETA</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">time</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;O$_2$ Flux (mol.m$^{-2}$.s$^{-1}$)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Vert Mixing of O$_2$ on &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dso</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">36</span><span class="p">:</span><span class="mi">46</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;latitude (N)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;longitude (E)&#39;</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">fsx</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">};</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">fsx</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">};</span> 
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylabels_right</span><span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">xlines</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylines</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lon_lab</span><span class="p">);</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lat_lab</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span> <span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>

    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span><span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="n">Wq</span><span class="p">,</span> <span class="o">-</span><span class="n">Eq</span><span class="p">,</span> <span class="n">Sq</span><span class="p">,</span> <span class="n">Nq</span><span class="p">],</span> <span class="n">crs</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">land_50m</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">)</span>
    <span class="n">p1</span><span class="o">=</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">surf_O2</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">i</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cmo.balance&#39;</span><span class="p">,</span><span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">2e-7</span><span class="p">,</span><span class="mf">2e-7</span><span class="p">,</span><span class="mf">0.01e-7</span><span class="p">),</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">dsv</span><span class="o">.</span><span class="n">THETA</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">time</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">24</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mf">0.5</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">p1</span><span class="p">)</span>
    <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;O$_2$ Flux (mol.m$^{-2}$.s$^{-1}$)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;O$_2$ Flux on &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dso</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">])[</span><span class="mi">36</span><span class="p">:</span><span class="mi">46</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;latitude (N)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;longitude (E)&#39;</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">fsx</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">};</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylabel_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="n">fsx</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">};</span> 
    <span class="n">gl</span><span class="o">.</span><span class="n">xlabels_top</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylabels_right</span><span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">xlines</span> <span class="o">=</span> <span class="kc">False</span><span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylines</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xlocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lon_lab</span><span class="p">);</span> <span class="n">gl</span><span class="o">.</span><span class="n">ylocator</span> <span class="o">=</span> <span class="n">mticker</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">(</span><span class="n">lat_lab</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">xformatter</span> <span class="o">=</span> <span class="n">LONGITUDE_FORMATTER</span> <span class="p">;</span> <span class="n">gl</span><span class="o">.</span><span class="n">yformatter</span> <span class="o">=</span> <span class="n">LATITUDE_FORMATTER</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 1/1 [00:11&lt;00:00, 11.85s/it]
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_31_1.png" src="../../../_images/Analysis_O2_Budget_MITgcm_31_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">16</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">gs2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>    <span class="c1">#, top=0.3, left=0.38, right=0.95, wspace=0.4, hspace=0.2)    </span>
<span class="n">LON_W</span><span class="o">=</span><span class="mi">360</span><span class="o">-</span><span class="mi">125</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">14</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">dsl</span><span class="o">.</span><span class="n">THETA</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="n">LON_W</span><span class="p">,</span><span class="n">YC</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SST at 4ºN, 125ºW&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="p">(</span><span class="n">dsol</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="n">LON_W</span><span class="p">,</span><span class="n">YC</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">PD</span><span class="o">=</span><span class="mf">1024.5</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;O2 on $\sigma$=24.5 at 4ºN, 125ºW&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="p">(</span><span class="o">-</span><span class="n">dsbl</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="n">LON_W</span><span class="p">,</span><span class="n">YC</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="o">-</span><span class="mi">150</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Vertical Mixing of O2 at 0º, 125ºW&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>


<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="p">(</span><span class="n">dsbl</span><span class="o">.</span><span class="n">surf_O2</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="n">LON_W</span><span class="p">,</span><span class="n">YC</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Air-to-sea O2 flux at 0º, 125ºW&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Time&#39;)
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_32_1.png" src="../../../_images/Analysis_O2_Budget_MITgcm_32_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">12</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">14</span>
<span class="n">gs2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>    <span class="c1">#, top=0.3, left=0.38, right=0.95, wspace=0.4, hspace=0.2)    </span>

<span class="n">LON_W</span><span class="o">=</span><span class="mi">360</span><span class="o">-</span><span class="mi">125</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">dsl</span><span class="o">.</span><span class="n">THETA</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="n">LON_W</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mf">0.1</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;thermal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;SST at 125ºW&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude (ºN)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="p">(</span><span class="o">-</span><span class="n">dsbl</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="n">LON_W</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span><span class="o">-</span><span class="mi">150</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.15e-7</span><span class="p">,</span><span class="mf">0.15e-7</span><span class="p">,</span><span class="mf">0.01e-8</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cmo.balance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Vertical Diffusive Mixing (50m-150m) at 125ºW&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude (ºN)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="p">(</span><span class="n">dsbl</span><span class="o">.</span><span class="n">surf_O2</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="n">LON_W</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">0.15e-6</span><span class="p">,</span><span class="mf">0.15e-6</span><span class="p">,</span><span class="mf">0.01e-7</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;cmo.balance&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Air-to-sea O2 flux at 125ºW&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Latitude (ºN)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0.5, 0, &#39;Time&#39;)
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_33_1.png" src="../../../_images/Analysis_O2_Budget_MITgcm_33_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">O2_rho</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/intergals/O2_24_26.nc&#39;</span><span class="p">)</span>
<span class="n">O2d</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/intergals/O2_50_150m.nc&#39;</span><span class="p">)</span>
<span class="n">dsbd</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/intergals/budget_50_150m.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">O2_m</span><span class="o">=</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">Du</span><span class="p">,</span><span class="n">Dl</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">}))</span>
<span class="n">O2_max</span><span class="o">=</span><span class="n">O2_m</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">O2_min</span><span class="o">=</span><span class="n">O2_m</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">O2_mn</span><span class="o">=</span><span class="n">O2_m</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">O2_rho</span><span class="o">=</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&gt;</span><span class="n">rho_u</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&lt;</span><span class="n">rho_d</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">}))</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="n">dsb_rho</span><span class="o">=</span><span class="p">(</span><span class="n">dsb</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&gt;</span><span class="n">rho_u</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&lt;</span><span class="n">rho_d</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tend_O2_rho</span><span class="o">=</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">tend_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&gt;</span><span class="n">rho_u</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&lt;</span><span class="n">rho_d</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="n">divh_O2_rho</span><span class="o">=</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">adv_h_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&gt;</span><span class="n">rho_u</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&lt;</span><span class="n">rho_d</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="n">divv_O2_rho</span><span class="o">=</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">adv_v_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&gt;</span><span class="n">rho_u</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&lt;</span><span class="n">rho_d</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="n">dif_O2_rho</span><span class="o">=</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&gt;</span><span class="n">rho_u</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&lt;</span><span class="n">rho_d</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="n">bio_O2_rho</span><span class="o">=</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">bio_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&gt;</span><span class="n">rho_u</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&lt;</span><span class="n">rho_d</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="n">surf_O2_rho</span><span class="o">=</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">surf_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">360</span><span class="o">-</span><span class="n">W</span><span class="p">,</span><span class="mi">360</span><span class="o">-</span><span class="n">E</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">YC</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">S</span><span class="p">,</span><span class="n">N</span><span class="p">))</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">({</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span><span class="s1">&#39;YC&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">O2_rho_mn</span><span class="o">=</span><span class="n">O2_rho</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">fs</span><span class="o">=</span><span class="mi">14</span>
<span class="n">gs2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="c1">#, top=0.3, left=0.38, right=0.95, wspace=0.4, hspace=0.2)    </span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">pc</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">time</span><span class="p">,</span><span class="n">O2_rho</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">Linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;O$_2$&#39;</span><span class="p">)</span>
<span class="c1"># ax.set_xlim([0., 13.])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time &#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;O$_2$ (mmol.m$^{-3})$)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;O$_2$ and EKE&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;royalblue&#39;</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;EKE(cm$^2$/s$^2$)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>  
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="o">-</span><span class="mi">9</span><span class="p">],</span><span class="n">EKE_m</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span><span class="mf">1e4</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">Linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;EKE&#39;</span><span class="p">)</span> 
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">labelcolor</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="n">fs</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># plt.xlim(1,12)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsbd</span><span class="o">.</span><span class="n">tend_O2</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">tend_O2_rho</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><span class="mi">6</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x2b077b251be0&gt;]
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_41_1.png" src="../../../_images/Analysis_O2_Budget_MITgcm_41_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">([</span><span class="mi">2015</span><span class="p">,</span><span class="mi">2014</span><span class="p">]):</span>
    <span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">tend_O2</span><span class="o">*</span><span class="n">dsw</span><span class="o">.</span><span class="n">rVOL</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&gt;</span><span class="n">rho_u</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&lt;</span><span class="n">rho_d</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="mi">360</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">400</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr&#39;</span><span class="p">)</span>
    <span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">TRAC03</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&gt;</span><span class="n">rho_u</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">PD</span><span class="o">&lt;</span><span class="n">rho_d</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">XC</span><span class="o">=</span><span class="mi">360</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.20</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;magma&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 2/2 [01:50&lt;00:00, 55.44s/it]
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_42_1.png" src="../../../_images/Analysis_O2_Budget_MITgcm_42_1.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_42_2.png" src="../../../_images/Analysis_O2_Budget_MITgcm_42_2.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_42_3.png" src="../../../_images/Analysis_O2_Budget_MITgcm_42_3.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_42_4.png" src="../../../_images/Analysis_O2_Budget_MITgcm_42_4.png" />
</div>
</div>
<section id="calculate-eddy-kinetic-energy-using-residual-from-from-90-days-running-mean">
<h2>Calculate Eddy Kinetic Energy using residual from from 90 days running mean:<a class="headerlink" href="#calculate-eddy-kinetic-energy-using-residual-from-from-90-days-running-mean" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">EKE</span><span class="p">(</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">Um</span><span class="p">,</span><span class="n">Vm</span><span class="p">):</span>
    <span class="n">U_p</span><span class="o">=</span><span class="p">(</span><span class="n">U</span><span class="o">-</span><span class="n">Um</span><span class="p">)</span>
    <span class="n">V_p</span><span class="o">=</span><span class="p">(</span><span class="n">V</span><span class="o">-</span><span class="n">Vm</span><span class="p">)</span>
    <span class="n">eke</span><span class="o">=</span><span class="p">((</span><span class="n">U_p</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">V_p</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>    
    <span class="k">return</span> <span class="n">eke</span>

<span class="k">def</span> <span class="nf">to_cell_center</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;XG&quot;</span><span class="p">]:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="s2">&quot;XC&quot;</span><span class="p">})</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dim</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;YG&quot;</span><span class="p">]:</span>
            <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="n">dim</span><span class="p">:</span> <span class="s2">&quot;YC&quot;</span><span class="p">})</span>            
    <span class="k">return</span> <span class="n">ds</span>

<span class="c1"># Calculate EKE</span>
<span class="n">dsu</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/variables_201?.nc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1">#.isel(time=np.arange(0,293))</span>
<span class="n">dsu</span><span class="o">=</span><span class="n">to_cell_center</span><span class="p">(</span><span class="n">dsu</span><span class="p">)</span>
<span class="n">ndays</span><span class="o">=</span><span class="mi">90</span><span class="p">;</span> <span class="n">ndt</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">ndays</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>
<span class="n">Urm</span><span class="o">=</span><span class="n">dsu</span><span class="o">.</span><span class="n">UVEL</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">ndt</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">Vrm</span><span class="o">=</span><span class="n">dsu</span><span class="o">.</span><span class="n">VVEL</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">ndt</span><span class="p">,</span><span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">eke</span><span class="o">=</span><span class="n">EKE</span><span class="p">(</span><span class="n">dsu</span><span class="o">.</span><span class="n">UVEL</span><span class="p">,</span><span class="n">dsu</span><span class="o">.</span><span class="n">VVEL</span><span class="p">,</span><span class="n">Urm</span><span class="p">,</span><span class="n">Vrm</span><span class="p">)</span>
<span class="n">eke</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/EKE_2010_2017.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">)):</span>
    <span class="n">N</span><span class="o">=</span><span class="mi">73</span>
    <span class="n">dsv</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/tpfwd6_?VEL_5day_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
    <span class="n">dst</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/tpfwd6_T*_5day_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
    <span class="n">dsp</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/tpfwd6_PD_5day_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
    <span class="n">dsb</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/tpfwd6_*_O2_5day_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
    <span class="n">dsb</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dst</span><span class="o">.</span><span class="n">time</span>
    <span class="n">dsb2</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/tpfwd6_adv_[hv][uw]O2_5day_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
    <span class="n">dsb2</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dst</span><span class="o">.</span><span class="n">time</span>
    <span class="n">dsb</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">dsb</span><span class="p">,</span><span class="n">dsb2</span><span class="p">],</span><span class="n">compat</span><span class="o">=</span><span class="s1">&#39;override&#39;</span><span class="p">)</span>
    <span class="n">dsb</span><span class="p">[</span><span class="s1">&#39;rVOL&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dst</span><span class="o">.</span><span class="n">drF</span><span class="o">*</span><span class="n">dst</span><span class="o">.</span><span class="n">rA</span><span class="o">*</span><span class="n">dst</span><span class="o">.</span><span class="n">hFacC</span>
    <span class="n">dst</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">dst</span><span class="p">,</span><span class="n">dsv</span><span class="p">,</span><span class="n">dsp</span><span class="p">],</span><span class="n">compat</span><span class="o">=</span><span class="s1">&#39;override&#39;</span><span class="p">)</span>
    <span class="n">dst</span><span class="p">[</span><span class="s1">&#39;rVOL&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">dst</span><span class="o">.</span><span class="n">drF</span><span class="o">*</span><span class="n">dst</span><span class="o">.</span><span class="n">rA</span><span class="o">*</span><span class="n">dst</span><span class="o">.</span><span class="n">hFacC</span>
    <span class="n">dsb</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/budgets_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>
    <span class="n">dst</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/variables_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 8/8 [08:59&lt;00:00, 67.42s/it]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gsw</span>

<span class="c1"># 5-day mean temp, O2 and salt from Forward MITgcm run with BGC</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">)):</span>
    <span class="n">dst</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/tpfwd6_THETA_5day_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>
    <span class="n">dss</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/tpfwd6_SALT_5day_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>
    <span class="n">dsp</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
    <span class="n">dsp</span><span class="p">[</span><span class="s1">&#39;PD&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">gsw</span><span class="o">.</span><span class="n">density</span><span class="o">.</span><span class="n">sigma0</span><span class="p">(</span><span class="n">dss</span><span class="o">.</span><span class="n">SALT</span><span class="p">,</span><span class="n">dst</span><span class="o">.</span><span class="n">THETA</span><span class="p">)</span><span class="o">+</span><span class="mi">1000</span>
    <span class="n">dsp</span><span class="o">.</span><span class="n">PD</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;Potential density&#39;</span>
    <span class="n">dsp</span><span class="o">.</span><span class="n">PD</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;kg m-3&#39;</span>
    <span class="n">dsp</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/tpfwd6_PD_5day_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 3/3 [01:11&lt;00:00, 23.78s/it]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1022.5</span><span class="p">,</span><span class="mf">1027.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>

<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">8</span><span class="p">)):</span>
    <span class="n">dsp</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/variables_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">,</span><span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="s2">&quot;XC&quot;</span><span class="p">:</span><span class="mi">300</span><span class="p">,</span><span class="s2">&quot;YC&quot;</span><span class="p">:</span><span class="mi">50</span><span class="p">})</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span><span class="n">dsp</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;center&#39;</span><span class="p">:</span><span class="s1">&#39;Z&#39;</span><span class="p">}},</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ds_rho</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
    <span class="n">ds_rho</span><span class="p">[</span><span class="s1">&#39;TRAC03&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dsp</span><span class="o">.</span><span class="n">TRAC03</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">target_data</span><span class="o">=</span><span class="n">dsp</span><span class="o">.</span><span class="n">PD</span><span class="p">)</span>
    <span class="n">ds_rho</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/budgets/rho_O2_5day_201&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 2/2 [09:47&lt;00:00, 293.83s/it]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xgcm</span> <span class="kn">import</span> <span class="n">Grid</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1022.5</span><span class="p">,</span><span class="mf">1027.5</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">Grid</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Z&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;center&#39;</span><span class="p">:</span><span class="s1">&#39;Z&#39;</span><span class="p">}},</span> <span class="n">periodic</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ds_rho</span><span class="o">=</span><span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
<span class="n">ds_rho</span><span class="p">[</span><span class="s1">&#39;O2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">TRAC03</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">target_data</span><span class="o">=</span><span class="n">dsp</span><span class="o">.</span><span class="n">PD</span><span class="p">)</span>
<span class="n">ds_rho</span><span class="p">[</span><span class="s1">&#39;tend_O2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">tend_O2</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">target_data</span><span class="o">=</span><span class="n">dsp</span><span class="o">.</span><span class="n">PD</span><span class="p">)</span>
<span class="n">ds_rho</span><span class="p">[</span><span class="s1">&#39;adv_h_O2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">adv_h_O2</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">target_data</span><span class="o">=</span><span class="n">dsp</span><span class="o">.</span><span class="n">PD</span><span class="p">)</span>
<span class="n">ds_rho</span><span class="p">[</span><span class="s1">&#39;adv_v_O2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">adv_v_O2</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">target_data</span><span class="o">=</span><span class="n">dsp</span><span class="o">.</span><span class="n">PD</span><span class="p">)</span>
<span class="n">ds_rho</span><span class="p">[</span><span class="s1">&#39;dif_v_O2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">dif_v_O2</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">target_data</span><span class="o">=</span><span class="n">dsp</span><span class="o">.</span><span class="n">PD</span><span class="p">)</span>
<span class="n">ds_rho</span><span class="p">[</span><span class="s1">&#39;j_O2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">bio_O2</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">target_data</span><span class="o">=</span><span class="n">dsp</span><span class="o">.</span><span class="n">PD</span><span class="p">)</span>

<span class="n">ds_rho</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/RHO_O2_5day_2010s.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">glade</span><span class="o">/</span><span class="n">scratch</span><span class="o">/</span><span class="n">yeddebba</span><span class="o">/</span><span class="n">ipykernel_88461</span><span class="o">/</span><span class="mf">2768936788.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">ds_rho</span><span class="p">[</span><span class="s1">&#39;j_O2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">dsb</span><span class="o">.</span><span class="n">bio_O2</span><span class="p">,</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span><span class="n">rho</span><span class="p">,</span><span class="n">target_data</span><span class="o">=</span><span class="n">dsp</span><span class="o">.</span><span class="n">PD</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> 
<span class="ne">---&gt; </span><span class="mi">12</span> <span class="n">ds_rho</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="s1">&#39;/glade/scratch/yeddebba/Mesoscale/TPOSE/MITgcm_BLING_BUDGET_2010_2013_5DAY/RHO_O2_5day_2010s.nc&#39;</span><span class="p">)</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/xarray/core/dataset.py</span> in <span class="ni">to_netcdf</span><span class="nt">(self, path, mode, format, group, engine, encoding, unlimited_dims, compute, invalid_netcdf)</span>
<span class="g g-Whitespace">   </span><span class="mi">1900</span>         <span class="kn">from</span> <span class="nn">..backends.api</span> <span class="kn">import</span> <span class="n">to_netcdf</span>
<span class="g g-Whitespace">   </span><span class="mi">1901</span> 
<span class="ne">-&gt; </span><span class="mi">1902</span>         <span class="k">return</span> <span class="n">to_netcdf</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1903</span>             <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1904</span>             <span class="n">path</span><span class="p">,</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/xarray/backends/api.py</span> in <span class="ni">to_netcdf</span><span class="nt">(dataset, path_or_file, mode, format, group, engine, encoding, unlimited_dims, compute, multifile, invalid_netcdf)</span>
<span class="g g-Whitespace">   </span><span class="mi">1079</span>             <span class="k">return</span> <span class="n">writer</span><span class="p">,</span> <span class="n">store</span>
<span class="g g-Whitespace">   </span><span class="mi">1080</span> 
<span class="ne">-&gt; </span><span class="mi">1081</span>         <span class="n">writes</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span><span class="n">compute</span><span class="o">=</span><span class="n">compute</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1082</span> 
<span class="g g-Whitespace">   </span><span class="mi">1083</span>         <span class="k">if</span> <span class="n">path_or_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/xarray/backends/common.py</span> in <span class="ni">sync</span><span class="nt">(self, compute)</span>
<span class="g g-Whitespace">    </span><span class="mi">164</span>             <span class="c1"># targets = [dask.delayed(t) for t in self.targets]</span>
<span class="g g-Whitespace">    </span><span class="mi">165</span> 
<span class="ne">--&gt; </span><span class="mi">166</span>             <span class="n">delayed_store</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">store</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">167</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">sources</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">168</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">targets</span><span class="p">,</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/dask/array/core.py</span> in <span class="ni">store</span><span class="nt">(sources, targets, lock, regions, compute, return_stored, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1075</span>     <span class="k">elif</span> <span class="n">compute</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1076</span>         <span class="n">store_dsk</span> <span class="o">=</span> <span class="n">HighLevelGraph</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">dependencies</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1077</span>         <span class="n">compute_as_if_collection</span><span class="p">(</span><span class="n">Array</span><span class="p">,</span> <span class="n">store_dsk</span><span class="p">,</span> <span class="n">map_keys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1078</span>         <span class="k">return</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1079</span> 

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/dask/base.py</span> in <span class="ni">compute_as_if_collection</span><span class="nt">(cls, dsk, keys, scheduler, get, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span>     <span class="n">schedule</span> <span class="o">=</span> <span class="n">get_scheduler</span><span class="p">(</span><span class="n">scheduler</span><span class="o">=</span><span class="n">scheduler</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="bp">cls</span><span class="p">,</span> <span class="n">get</span><span class="o">=</span><span class="n">get</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span>     <span class="n">dsk2</span> <span class="o">=</span> <span class="n">optimization_function</span><span class="p">(</span><span class="bp">cls</span><span class="p">)(</span><span class="n">dsk</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">315</span>     <span class="k">return</span> <span class="n">schedule</span><span class="p">(</span><span class="n">dsk2</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">316</span> 
<span class="g g-Whitespace">    </span><span class="mi">317</span> 

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/distributed/client.py</span> in <span class="ni">get</span><span class="nt">(self, dsk, keys, workers, allow_other_workers, resources, sync, asynchronous, direct, retries, priority, fifo_timeout, actors, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2720</span>                     <span class="n">should_rejoin</span> <span class="o">=</span> <span class="kc">False</span>
<span class="g g-Whitespace">   </span><span class="mi">2721</span>             <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2722</span>                 <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gather</span><span class="p">(</span><span class="n">packed</span><span class="p">,</span> <span class="n">asynchronous</span><span class="o">=</span><span class="n">asynchronous</span><span class="p">,</span> <span class="n">direct</span><span class="o">=</span><span class="n">direct</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2723</span>             <span class="k">finally</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2724</span>                 <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">futures</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/distributed/client.py</span> in <span class="ni">gather</span><span class="nt">(self, futures, errors, direct, asynchronous)</span>
<span class="g g-Whitespace">   </span><span class="mi">1975</span>             <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1976</span>                 <span class="n">local_worker</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1977</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1978</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">_gather</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1979</span>                 <span class="n">futures</span><span class="p">,</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/distributed/client.py</span> in <span class="ni">sync</span><span class="nt">(self, func, asynchronous, callback_timeout, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">863</span>             <span class="k">return</span> <span class="n">future</span>
<span class="g g-Whitespace">    </span><span class="mi">864</span>         <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">865</span>             <span class="k">return</span> <span class="n">sync</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">866</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">loop</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">callback_timeout</span><span class="o">=</span><span class="n">callback_timeout</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="g g-Whitespace">    </span><span class="mi">867</span>             <span class="p">)</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/distributed/utils.py</span> in <span class="ni">sync</span><span class="nt">(loop, func, callback_timeout, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">325</span>     <span class="k">if</span> <span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
<span class="g g-Whitespace">    </span><span class="mi">326</span>         <span class="n">typ</span><span class="p">,</span> <span class="n">exc</span><span class="p">,</span> <span class="n">tb</span> <span class="o">=</span> <span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="ne">--&gt; </span><span class="mi">327</span>         <span class="k">raise</span> <span class="n">exc</span><span class="o">.</span><span class="n">with_traceback</span><span class="p">(</span><span class="n">tb</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">329</span>         <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/distributed/utils.py</span> in <span class="ni">f</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">308</span>             <span class="k">if</span> <span class="n">callback_timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>                 <span class="n">future</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">future</span><span class="p">,</span> <span class="n">callback_timeout</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">310</span>             <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">future</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span>         <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span>             <span class="n">error</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/tornado/gen.py</span> in <span class="ni">run</span><span class="nt">(self)</span>
<span class="g g-Whitespace">    </span><span class="mi">760</span> 
<span class="g g-Whitespace">    </span><span class="mi">761</span>                     <span class="k">try</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">762</span>                         <span class="n">value</span> <span class="o">=</span> <span class="n">future</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">763</span>                     <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">764</span>                         <span class="n">exc_info</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">exc_info</span><span class="p">()</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/distributed/client.py</span> in <span class="ni">_gather</span><span class="nt">(self, futures, errors, direct, local_worker)</span>
<span class="g g-Whitespace">   </span><span class="mi">1840</span>                             <span class="n">exc</span> <span class="o">=</span> <span class="n">CancelledError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1841</span>                         <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1842</span>                             <span class="k">raise</span> <span class="n">exception</span><span class="o">.</span><span class="n">with_traceback</span><span class="p">(</span><span class="n">traceback</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1843</span>                         <span class="k">raise</span> <span class="n">exc</span>
<span class="g g-Whitespace">   </span><span class="mi">1844</span>                     <span class="k">if</span> <span class="n">errors</span> <span class="o">==</span> <span class="s2">&quot;skip&quot;</span><span class="p">:</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/dask/array/core.py</span> in <span class="ni">store_chunk</span><span class="nt">()</span>
<span class="g g-Whitespace">   </span><span class="mi">4048</span> 
<span class="g g-Whitespace">   </span><span class="mi">4049</span> <span class="k">def</span> <span class="nf">store_chunk</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">lock</span><span class="p">,</span> <span class="n">return_stored</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">4050</span>     <span class="k">return</span> <span class="n">load_store_chunk</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">lock</span><span class="p">,</span> <span class="n">return_stored</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4051</span> 
<span class="g g-Whitespace">   </span><span class="mi">4052</span> 

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/dask/array/core.py</span> in <span class="ni">load_store_chunk</span><span class="nt">()</span>
<span class="g g-Whitespace">   </span><span class="mi">4035</span>         <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4036</span>             <span class="k">if</span> <span class="n">is_arraylike</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">4037</span>                 <span class="n">out</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
<span class="g g-Whitespace">   </span><span class="mi">4038</span>             <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4039</span>                 <span class="n">out</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/xarray/backends/netCDF4_.py</span> in <span class="ni">__setitem__</span><span class="nt">()</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span> 
<span class="g g-Whitespace">     </span><span class="mi">66</span>     <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="ne">---&gt; </span><span class="mi">67</span>         <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">datastore</span><span class="o">.</span><span class="n">lock</span><span class="p">:</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span>             <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_array</span><span class="p">(</span><span class="n">needs_lock</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span>             <span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/xarray/backends/locks.py</span> in <span class="ni">__enter__</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span>     <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">159</span>         <span class="k">for</span> <span class="n">lock</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locks</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">160</span>             <span class="n">lock</span><span class="o">.</span><span class="fm">__enter__</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span> 
<span class="g g-Whitespace">    </span><span class="mi">162</span>     <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/distributed/lock.py</span> in <span class="ni">__enter__</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">158</span> 
<span class="g g-Whitespace">    </span><span class="mi">159</span>     <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">160</span>         <span class="bp">self</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">161</span>         <span class="k">return</span> <span class="bp">self</span>
<span class="g g-Whitespace">    </span><span class="mi">162</span> 

<span class="nn">/glade/work/yeddebba/miniconda3/envs/omz_env/lib/python3.8/site-packages/distributed/lock.py</span> in <span class="ni">acquire</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">136</span> 
<span class="g g-Whitespace">    </span><span class="mi">137</span>         <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">138</span>             <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">scheduler</span><span class="o">.</span><span class="n">lock_acquire</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">139</span>             <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">140</span>             <span class="nb">id</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>

<span class="ne">AttributeError</span>: &#39;NoneType&#39; object has no attribute &#39;lock_acquire&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    
<span class="n">t1</span><span class="o">=</span><span class="s1">&#39;2010-07&#39;</span>
<span class="n">t2</span><span class="o">=</span><span class="s1">&#39;2011-07&#39;</span>
<span class="p">(</span><span class="n">EKE</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">*</span><span class="mf">1e4</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Glacial&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">8e2</span><span class="p">)</span>
<span class="p">(</span><span class="n">anomaly</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">THETA</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="n">ds_rho</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">PD</span><span class="o">=</span><span class="mi">1026</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;sunset_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">2.2e2</span><span class="p">)</span>
<span class="p">(</span><span class="n">ds_rho</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">PD</span><span class="o">=</span><span class="mi">1026</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">t1</span><span class="o">=</span><span class="s1">&#39;2015-07&#39;</span>
<span class="n">t2</span><span class="o">=</span><span class="s1">&#39;2016-07&#39;</span>

<span class="p">(</span><span class="n">EKE</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">*</span><span class="mf">1e4</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Glacial&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">8e2</span><span class="p">)</span>
<span class="p">(</span><span class="n">anomaly</span><span class="p">(</span><span class="n">dsv</span><span class="o">.</span><span class="n">THETA</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">Z</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;seismic&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="n">ds_rho</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">PD</span><span class="o">=</span><span class="mi">1026</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;sunset_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">2.2e2</span><span class="p">)</span>
<span class="p">(</span><span class="n">ds_rho</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">PD</span><span class="o">=</span><span class="mi">1026</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span><span class="n">t2</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">rho</span><span class="o">=</span><span class="mf">1026.0</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">]):</span>
    <span class="n">t1</span><span class="o">=</span><span class="s1">&#39;2011-0&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="p">(</span><span class="n">ds_rho</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">PD</span><span class="o">=</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;sunset_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">2.5e2</span><span class="p">)</span>
    <span class="p">(</span><span class="n">ds_rho</span><span class="o">.</span><span class="n">TRAC03</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">PD</span><span class="o">=</span><span class="n">rho</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">t1</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">*</span><span class="mf">1e3</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;XC&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;YC&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">t1</span><span class="p">))</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.contour.QuadContourSet at 0x2b075af45730&gt;
</pre></div>
</div>
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_49_1.png" src="../../../_images/Analysis_O2_Budget_MITgcm_49_1.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_49_2.png" src="../../../_images/Analysis_O2_Budget_MITgcm_49_2.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_49_3.png" src="../../../_images/Analysis_O2_Budget_MITgcm_49_3.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_49_4.png" src="../../../_images/Analysis_O2_Budget_MITgcm_49_4.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_49_5.png" src="../../../_images/Analysis_O2_Budget_MITgcm_49_5.png" />
<img alt="../../../_images/Analysis_O2_Budget_MITgcm_49_6.png" src="../../../_images/Analysis_O2_Budget_MITgcm_49_6.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "conda-env-miniconda3-omz_env-py"
        },
        kernelOptions: {
            kernelName: "conda-env-miniconda3-omz_env-py",
            path: "./notebooks/budget_analysis/working"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'conda-env-miniconda3-omz_env-py'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Yassir Eddebbar<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>